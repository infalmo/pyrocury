[{"text": "The following content is\nprovided under a Creative", "start": 0.08, "duration": 2.35}, {"text": "Commons license.", "start": 2.43, "duration": 1.39}, {"text": "Your support will help\nMIT OpenCourseWare", "start": 3.82, "duration": 2.24}, {"text": "continue to offer high quality\neducational resources for free.", "start": 6.06, "duration": 4.09}, {"text": "To make a donation or to\nview additional materials", "start": 10.15, "duration": 2.54}, {"text": "from hundreds of MIT courses,\nvisit MIT OpenCourseWare", "start": 12.69, "duration": 3.91}, {"text": "at ocw.mit.edu.", "start": 16.6, "duration": 0.66}, {"text": "PROFESSOR: So today, we're going\nto talk about Kerberos, which", "start": 26.34, "duration": 2.81}, {"text": "is a cryptographically\nsecure, in some ways,", "start": 29.15, "duration": 3.6}, {"text": "protocol for\nauthenticating computers", "start": 32.75, "duration": 3.46}, {"text": "and applications to one\nanother over the network.", "start": 36.21, "duration": 2.461}, {"text": "So this is now finally\ngoing to use cryptography", "start": 38.671, "duration": 1.999}, {"text": "whereas last lecture,\nwe looked at just", "start": 40.67, "duration": 1.82}, {"text": "using these TCP sequence\nnumbers to provide security.", "start": 42.49, "duration": 3.752}, {"text": "So before we dive\ninto the details,", "start": 46.242, "duration": 1.458}, {"text": "I want to mention there's\ntwo bits of administrivia", "start": 47.7, "duration": 2.125}, {"text": "that you might want to know.", "start": 49.825, "duration": 2.145}, {"text": "There's a quiz review today\n7 to 9 o'clock in some room,", "start": 51.97, "duration": 3.05}, {"text": "I think 32 or 23.", "start": 55.02, "duration": 1.55}, {"text": "It's on schedule page and\nthe quiz is next Wednesday.", "start": 56.57, "duration": 3.34}, {"text": "And also, we want\nyou guys to post", "start": 59.91, "duration": 1.85}, {"text": "some idea for your\nfinal project on Piazza", "start": 61.76, "duration": 2.14}, {"text": "by tomorrow just so\nthat your classmates can", "start": 63.9, "duration": 3.9}, {"text": "know what you're thinking\nand help you form groups.", "start": 67.8, "duration": 4.635}, {"text": "All right, so let's talk\nabout Kerberos, all right?", "start": 72.435, "duration": 2.125}, {"text": "So what is the\nsetting that Kerberos", "start": 74.56, "duration": 2.02}, {"text": "is trying to support, here?", "start": 76.58, "duration": 2.78}, {"text": "So the model for\nKerberos, what these guys", "start": 79.36, "duration": 2.54}, {"text": "had in mind when\nthey were designing", "start": 81.9, "duration": 1.78}, {"text": "Athena guess 25 or\n30 years ago now,", "start": 83.68, "duration": 2.92}, {"text": "is that they were\nimagining they were", "start": 86.6, "duration": 1.76}, {"text": "going to have a network\nwith many server machines", "start": 88.36, "duration": 2.32}, {"text": "and many client machines\ninteracting with one another.", "start": 90.68, "duration": 3.11}, {"text": "So you could imagine, well, you\nhave a file server somewhere", "start": 93.79, "duration": 2.5}, {"text": "out there.", "start": 96.29, "duration": 0.86}, {"text": "You probably have a mail server\nconnected to the network, maybe", "start": 97.15, "duration": 3.99}, {"text": "other services-- printer.", "start": 101.14, "duration": 3.99}, {"text": "And all these are just connected\nto some sort of a network", "start": 105.13, "duration": 5.38}, {"text": "rather than being processes\non a single machine.", "start": 110.51, "duration": 3.99}, {"text": "So the prelude to\nAthena and Kerberos", "start": 114.5, "duration": 2.997}, {"text": "is that you just have a\ntime sharing machine where", "start": 117.497, "duration": 2.083}, {"text": "everything was a single\nprocess and everyone would just", "start": 119.58, "duration": 2.47}, {"text": "log into the same system\nand store their files there.", "start": 122.05, "duration": 3.71}, {"text": "So these guys wanted a\nmore distributed system.", "start": 125.76, "duration": 3.07}, {"text": "So this meant that you'd have\nthese servers on one side", "start": 128.83, "duration": 3.53}, {"text": "and you'd also have a\nbunch of workstations", "start": 132.36, "duration": 2.37}, {"text": "that users would\nuse themselves which", "start": 134.73, "duration": 3.477}, {"text": "would run applications\nand potentially", "start": 138.207, "duration": 1.583}, {"text": "connect to these servers\nand store the user's files,", "start": 139.79, "duration": 2.57}, {"text": "get their mail et cetera.", "start": 142.36, "duration": 2.2}, {"text": "And the problem that\nthey wanted to solve", "start": 144.56, "duration": 2.24}, {"text": "was how to authenticate\nthe users that", "start": 146.8, "duration": 1.72}, {"text": "are using these workstations\nto all these different servers", "start": 148.52, "duration": 3.07}, {"text": "in the back end without\nhaving to trust the network", "start": 151.59, "duration": 2.68}, {"text": "to be correct, which seems\nlike a sensible design", "start": 154.27, "duration": 2.62}, {"text": "requirement in many ways.", "start": 156.89, "duration": 3.12}, {"text": "And I should\nmention that I guess", "start": 160.01, "duration": 2.88}, {"text": "the alternative to\nKerberos at the time", "start": 162.89, "duration": 1.69}, {"text": "was these R login\ncommands that we're", "start": 164.58, "duration": 1.607}, {"text": "looking at in last lecture,\nwhich seems like a bad plan.", "start": 166.187, "duration": 2.333}, {"text": "They just use IP addresses\nto authenticate the users.", "start": 168.52, "duration": 3.34}, {"text": "And Kerberos was\nreasonably successful.", "start": 171.86, "duration": 2.47}, {"text": "It actually still\nis used at MIT.", "start": 174.33, "duration": 1.83}, {"text": "And actually, it's the basis\nof Microsoft's Active Directory", "start": 176.16, "duration": 3.12}, {"text": "server.", "start": 179.28, "duration": 0.5}, {"text": "So pretty much every Microsoft\nbased sort of Windows Server", "start": 179.78, "duration": 3.67}, {"text": "uses Kerberos in\nsome form or another.", "start": 183.45, "duration": 2.471}, {"text": "But of course,\nbecause this protocol", "start": 185.921, "duration": 1.499}, {"text": "was designed 25 or 30 years\nago, requirements change.", "start": 187.42, "duration": 4.3}, {"text": "What people assume change.", "start": 191.72, "duration": 2.632}, {"text": "People now understand\nmuch more about security.", "start": 194.352, "duration": 1.958}, {"text": "So their version of\nKerberos that's in use today", "start": 196.31, "duration": 2.74}, {"text": "is noticeably\ndifferent in many ways", "start": 199.05, "duration": 2.72}, {"text": "from the version in the paper.", "start": 201.77, "duration": 2.09}, {"text": "And we'll look at exactly what\nassumptions aren't good enough", "start": 203.86, "duration": 3.66}, {"text": "anymore today and what\ndid they get wrong.", "start": 207.52, "duration": 2.912}, {"text": "It's sort of inevitable\nfor any protocol that", "start": 210.432, "duration": 1.958}, {"text": "was the first protocol to\nreally use cryptography", "start": 212.39, "duration": 2.26}, {"text": "to authenticate parties over\nthe network in this sort", "start": 214.65, "duration": 2.81}, {"text": "of full system scale.", "start": 217.46, "duration": 3.35}, {"text": "Anyway, so that's the sort\nof setting for Kerberos.", "start": 220.81, "duration": 2.612}, {"text": "And it might be\ninteresting to figure out", "start": 223.422, "duration": 1.708}, {"text": "what's the trust model, right?", "start": 225.13, "duration": 1.249}, {"text": "So Kerberos is going to\nintroduce this extra Kerberos", "start": 226.379, "duration": 3.531}, {"text": "server sitting on the side.", "start": 229.91, "duration": 1.54}, {"text": "So our third model\nat some level is", "start": 235.24, "duration": 2.8}, {"text": "that the network is\nuntrusted like we were", "start": 238.04, "duration": 2.67}, {"text": "thinking about in last lecture.", "start": 240.71, "duration": 2.71}, {"text": "But who do we have to trust\nin this Kerberos setting?", "start": 243.42, "duration": 3.325}, {"text": "So of course, one thing is\neveryone-- all parties have", "start": 249.7, "duration": 4.95}, {"text": "to trust the Kerberos server.", "start": 254.65, "duration": 1.58}, {"text": "So that's an assumption\nthese guys were", "start": 258.574, "duration": 1.625}, {"text": "willing to make at the time\nthat this Kerberos server would", "start": 260.199, "duration": 2.458}, {"text": "be in charge of all\nnetwork authentication", "start": 262.657, "duration": 2.258}, {"text": "in some form or another.", "start": 264.915, "duration": 2.52}, {"text": "Do we have anyone else\nthat has to trust anything", "start": 267.435, "duration": 2.495}, {"text": "in the setting?", "start": 269.93, "duration": 0.74}, {"text": "For example, yeah.", "start": 273.21, "duration": 0.75}, {"text": "STUDENT: Well users should\ntrust their own machines.", "start": 273.96, "duration": 2.344}, {"text": "PROFESSOR: Yes, so that's\na good point, right?", "start": 276.304, "duration": 1.916}, {"text": "There's the users that\nI didn't draw here.", "start": 278.22, "duration": 2.81}, {"text": "But these guys are\nusing some workstation.", "start": 281.03, "duration": 2.75}, {"text": "And it's actually pretty\nimportant in Kerberos", "start": 283.78, "duration": 2.37}, {"text": "that the user trusts\ntheir workstation.", "start": 286.15, "duration": 4.049}, {"text": "So what goes wrong if you\ndon't trust your workstation?", "start": 290.199, "duration": 2.291}, {"text": "Or presumably, it can\njust sniff your password", "start": 292.49, "duration": 1.916}, {"text": "and do whatever you type-- you\nknow, LS, it tries-- runs RMX.", "start": 294.406, "duration": 4.999}, {"text": "That seems kind of unfortunate.", "start": 299.405, "duration": 2.545}, {"text": "Yeah.", "start": 301.95, "duration": 0.714}, {"text": "STUDENT: But it's\nmore than that though,", "start": 302.664, "duration": 1.666}, {"text": "because they could even, like,\nsniff your Kerberos ticket.", "start": 304.33, "duration": 2.69}, {"text": "PROFESSOR: Yeah, exactly.", "start": 307.02, "duration": 0.57}, {"text": "Or when you log in, you\ntype in your password, which", "start": 307.59, "duration": 2.12}, {"text": "is even worse than the ticket.", "start": 309.71, "duration": 1.25}, {"text": "Yeah, absolutely, yeah.", "start": 310.96, "duration": 1.28}, {"text": "So this is actually a bit\nof a problem with Kerberos", "start": 312.24, "duration": 3.25}, {"text": "in the sense that if you don't\ntrust the workstation, then", "start": 315.49, "duration": 3.56}, {"text": "you're in a bit of trouble.", "start": 319.05, "duration": 2.0}, {"text": "So if you have your\nown laptop, this", "start": 321.05, "duration": 2.15}, {"text": "seems like a sensible\nassumption to make.", "start": 323.2, "duration": 1.83}, {"text": "If you're using a\npublic computer,", "start": 325.03, "duration": 2.11}, {"text": "this is a bit more questionable.", "start": 327.14, "duration": 1.345}, {"text": "And we'll see exactly\nwhat could go wrong.", "start": 328.485, "duration": 2.375}, {"text": "Yeah.", "start": 330.86, "duration": 0.823}, {"text": "STUDENT: You have to trust the\npeople administrating aren't", "start": 331.683, "duration": 2.958}, {"text": "doing anything bad with\n[INAUDIBLE] servers", "start": 334.641, "duration": 2.465}, {"text": "and giving them privilege\naccess to one another.", "start": 337.106, "duration": 2.866}, {"text": "STUDENT: So what do you mean?", "start": 339.972, "duration": 1.208}, {"text": "So of course,\nlike, ISNT is going", "start": 341.18, "duration": 2.04}, {"text": "to run these machines down here.", "start": 343.22, "duration": 2.79}, {"text": "But I think the machines\nthemselves don't necessarily", "start": 346.01, "duration": 2.29}, {"text": "have to trust one another.", "start": 348.3, "duration": 1.55}, {"text": "So the mail server doesn't trust\nthe print server or the file", "start": 349.85, "duration": 3.16}, {"text": "server necessarily.", "start": 353.01, "duration": 1.898}, {"text": "STUDENT: Not to\ntrust, but he might", "start": 354.908, "duration": 1.458}, {"text": "be able to access\na server you're not", "start": 356.366, "duration": 1.928}, {"text": "supposed to have access to by\ngoing through another server.", "start": 358.294, "duration": 3.203}, {"text": "PROFESSOR: Yeah,\nthat's true, I guess.", "start": 361.497, "duration": 1.583}, {"text": "Yeah, so if you set up\nany trust relationship", "start": 363.08, "duration": 1.96}, {"text": "between these guys-- like,\nif you give the mail server", "start": 365.04, "duration": 2.32}, {"text": "some back end to go access your\nfiles just for convenience,", "start": 367.36, "duration": 4.17}, {"text": "then this could be abused, yeah.", "start": 371.53, "duration": 1.61}, {"text": "So you have to be careful\nabout not introducing", "start": 373.14, "duration": 3.26}, {"text": "additional sort of levels of\ntrust or trust relations here.", "start": 376.4, "duration": 4.59}, {"text": "All right, anything\nelse that matters here?", "start": 380.99, "duration": 4.11}, {"text": "Do the servers have\nto trust the users", "start": 385.1, "duration": 1.99}, {"text": "in any way or the workstations?", "start": 387.09, "duration": 2.12}, {"text": "No, I guess presumably not.", "start": 391.776, "duration": 1.124}, {"text": "So this was the whole\ngoal that the server", "start": 392.9, "duration": 3.02}, {"text": "doesn't have to a priori\neven know necessarily", "start": 395.92, "duration": 2.24}, {"text": "what all these users or\nhow to authenticate them", "start": 398.16, "duration": 2.16}, {"text": "or what this workstation\nis doing until it can", "start": 400.32, "duration": 2.9}, {"text": "cryptographically prove that\nthis is a legitimate user", "start": 403.22, "duration": 3.88}, {"text": "and they should have access\nto their data or whatnot.", "start": 407.1, "duration": 4.36}, {"text": "All right, so let's look\nat how does Kerberos work", "start": 411.46, "duration": 2.14}, {"text": "or what's the overall\narchitecture, at least.", "start": 413.6, "duration": 3.74}, {"text": "So the plan that\nthese guys had in mind", "start": 417.34, "duration": 3.86}, {"text": "is that there would be\nthis Kerberos server.", "start": 421.2, "duration": 2.3}, {"text": "We have drawn it up\nthere but let's draw it", "start": 423.5, "duration": 1.97}, {"text": "in a slightly bigger scale.", "start": 425.47, "duration": 1.83}, {"text": "So this is the Kerberos server.", "start": 427.3, "duration": 3.24}, {"text": "And today, it's typically called\nKDC-- Key Distribution Center.", "start": 430.54, "duration": 6.11}, {"text": "And there's all these users\nout here somewhere and also", "start": 436.65, "duration": 5.78}, {"text": "services that you might\nwant to connect to.", "start": 442.43, "duration": 4.41}, {"text": "And the plan is that\nthe Kerberos server", "start": 446.84, "duration": 4.02}, {"text": "is going to be responsible\nfor storing a shared", "start": 450.86, "duration": 3.79}, {"text": "key between the Kerberos server\nand every entity in the world,", "start": 454.65, "duration": 4.42}, {"text": "or in this realm at least.", "start": 459.07, "duration": 2.01}, {"text": "So if the user has some\nsort of a key KC for client,", "start": 461.08, "duration": 4.805}, {"text": "than the Kerberos\nserver is going", "start": 465.885, "duration": 1.375}, {"text": "to remember this\nkey somewhere here.", "start": 467.26, "duration": 2.46}, {"text": "And similarly for the\nserver, the key KS", "start": 469.72, "duration": 3.96}, {"text": "is going to be known\nto the service itself", "start": 473.68, "duration": 2.4}, {"text": "and to the Kerberos server\nbut hopefully no one else.", "start": 476.08, "duration": 3.22}, {"text": "So you can think of it as like\na generalization of passwords,", "start": 479.3, "duration": 2.72}, {"text": "right?", "start": 482.02, "duration": 0.5}, {"text": "So you know a password\nand the Kerberos server", "start": 482.52, "duration": 1.92}, {"text": "knows your password\nbut no one else.", "start": 484.44, "duration": 1.5}, {"text": "And this is how you guys are\ngoing to prove to each other,", "start": 485.94, "duration": 2.85}, {"text": "yeah, I'm the right guy.", "start": 488.79, "duration": 1.34}, {"text": "I know this password\nand no one else does.", "start": 490.13, "duration": 2.87}, {"text": "Makes sense?", "start": 493.0, "duration": 1.15}, {"text": "And the other thing the Kerberos\nserver is going to have to do", "start": 494.15, "duration": 3.832}, {"text": "is, of course, keep\ntrack of who is", "start": 497.982, "duration": 2.088}, {"text": "it that owns this key, right?", "start": 500.07, "duration": 2.3}, {"text": "So it's going to have this table\nmapping some sort of a name.", "start": 502.37, "duration": 4.71}, {"text": "So this is some sort of a user.", "start": 507.08, "duration": 2.0}, {"text": "This is maybe service maybe\nAFS or something like this.", "start": 509.08, "duration": 6.55}, {"text": "And the KDC is responsible for\nstoring the gigantic table--", "start": 515.63, "duration": 2.9}, {"text": "well, not very large in\nterms of the number of bytes,", "start": 518.53, "duration": 3.129}, {"text": "necessarily, but\none entry per entity", "start": 521.659, "duration": 3.981}, {"text": "at MIT that the Kerberos\nserver knows about.", "start": 525.64, "duration": 4.67}, {"text": "Makes sense?", "start": 530.31, "duration": 2.2}, {"text": "All right, and then we're\ngoing to have sort of provide", "start": 532.51, "duration": 4.124}, {"text": "two interfaces, right?", "start": 536.634, "duration": 0.916}, {"text": "The paper is a little\nfuzzy above this", "start": 537.55, "duration": 2.65}, {"text": "or it pretends like there's\nreally two services.", "start": 540.2, "duration": 2.0}, {"text": "But really, what's going on\nis that there's two interfaces", "start": 542.2, "duration": 3.06}, {"text": "to the same machine.", "start": 545.26, "duration": 1.4}, {"text": "One of them is called Kerberos\nin the paper and one of them", "start": 546.66, "duration": 4.9}, {"text": "is called TGS for\nTicket Granting Service.", "start": 551.56, "duration": 3.9}, {"text": "And really, these\nare just two ways", "start": 555.46, "duration": 1.52}, {"text": "of talking to the same\nthing in the back end.", "start": 556.98, "duration": 3.15}, {"text": "And the protocol is a little\ndifferent for these things.", "start": 560.13, "duration": 4.21}, {"text": "So initially, when\nthe user logs in,", "start": 564.34, "duration": 2.23}, {"text": "they're going to talk\nto this guy over here.", "start": 566.57, "duration": 2.11}, {"text": "And they're going to\nsend their client name,", "start": 568.68, "duration": 3.43}, {"text": "C. So this might be\nyour Athena username.", "start": 572.11, "duration": 3.05}, {"text": "And the server is\ngoing to respond", "start": 575.16, "duration": 1.65}, {"text": "to back with a ticket,\na TGS or-- well,", "start": 576.81, "duration": 6.994}, {"text": "some sort of a ticket.", "start": 583.804, "duration": 0.916}, {"text": "We'll look at the\ndetails in a bit.", "start": 584.72, "duration": 1.82}, {"text": "And then when you want to\ntalk to some server down here,", "start": 586.54, "duration": 4.59}, {"text": "KS, then you're going to\ntalk to this TGS first", "start": 591.13, "duration": 2.91}, {"text": "and say, oh, hey,\nI already logged in", "start": 594.04, "duration": 2.49}, {"text": "through the Kerberos interface.", "start": 596.53, "duration": 2.03}, {"text": "Now, I want to talk\nto the server S.", "start": 598.56, "duration": 2.21}, {"text": "So you'd tell the TGS about\nthe server you want to talk to.", "start": 600.77, "duration": 2.79}, {"text": "And then it returns you\nback some sort of a ticket", "start": 603.56, "duration": 4.77}, {"text": "for talking to the server\nS. And then you can finally", "start": 608.33, "duration": 4.45}, {"text": "start talking to\nthe server over here", "start": 612.78, "duration": 2.82}, {"text": "by initially passing\nit this ticket for S.", "start": 615.6, "duration": 6.63}, {"text": "Does this all make sense?", "start": 622.23, "duration": 1.672}, {"text": "This is the sort\nof high level plan.", "start": 623.902, "duration": 3.368}, {"text": "So why do these guys\nhave two interfaces?", "start": 627.27, "duration": 3.065}, {"text": "Well, I guess I\nwanted to actually ask", "start": 632.967, "duration": 1.583}, {"text": "a bunch of questions.", "start": 634.55, "duration": 0.875}, {"text": "Like, in the case of a\nservice, this service", "start": 635.425, "duration": 2.655}, {"text": "is probably going to\nbe stored on disk.", "start": 638.08, "duration": 1.69}, {"text": "What's going on with\nthis KC on the user side?", "start": 639.77, "duration": 2.56}, {"text": "Where does KC come\nfrom in Kerberos?", "start": 642.33, "duration": 3.91}, {"text": "Yeah.", "start": 646.24, "duration": 1.334}, {"text": "STUDENT: KDMS\n[INAUDIBLE] the database.", "start": 647.574, "duration": 3.166}, {"text": "PROFESSOR: Yeah, well,\nthe key C sits here.", "start": 650.74, "duration": 1.996}, {"text": "And that's absolutely true.", "start": 652.736, "duration": 1.124}, {"text": "It's sits on this\ngiant database.", "start": 653.86, "duration": 1.56}, {"text": "But it also has to\nbe known to the user", "start": 655.42, "duration": 1.86}, {"text": "because the user has to\nprove that they are the user.", "start": 657.28, "duration": 2.33}, {"text": "Yeah.", "start": 659.61, "duration": 0.716}, {"text": "STUDENT: Is that a one way\nfunction and then the password?", "start": 660.326, "duration": 1.704}, {"text": "PROFESSOR: Yeah,\nso they actually", "start": 662.03, "duration": 1.375}, {"text": "have this sort of cute plan\nwhere the KC is actually", "start": 663.405, "duration": 2.525}, {"text": "going to be derived by\nhashing the user's password", "start": 665.93, "duration": 3.17}, {"text": "or really some sort of\nkey duration function.", "start": 669.1, "duration": 2.22}, {"text": "And there's several different\nones of perverse uses.", "start": 671.32, "duration": 3.124}, {"text": "But you're basically\ngoing to take a password,", "start": 674.444, "duration": 1.916}, {"text": "transform it in some\nway, and get this key KC.", "start": 676.36, "duration": 4.316}, {"text": "All right, so that seems good.", "start": 680.676, "duration": 4.504}, {"text": "Why do we need two\nprotocols, right?", "start": 685.18, "duration": 1.83}, {"text": "You could imagine that you just\nalways ask the Kerberos server", "start": 687.01, "duration": 5.01}, {"text": "for tickets directly this way.", "start": 692.02, "duration": 1.272}, {"text": "You say, well, hey,\nI want a ticket", "start": 693.292, "duration": 1.458}, {"text": "for this particular\nprinciple name.", "start": 694.75, "duration": 1.98}, {"text": "And it'll send you back a\nticket and you can decrypt it", "start": 696.73, "duration": 2.34}, {"text": "with your KC afterwards.", "start": 699.07, "duration": 2.37}, {"text": "Yeah.", "start": 701.44, "duration": 0.5}, {"text": "STUDENT: Can you\n[INAUDIBLE] or ask the user", "start": 701.94, "duration": 2.921}, {"text": "to reenter their\npassword each time they", "start": 704.861, "duration": 1.666}, {"text": "want to [INAUDIBLE] service?", "start": 706.527, "duration": 1.213}, {"text": "PROFESSOR: Right, so the\nreason for the difference", "start": 707.74, "duration": 2.083}, {"text": "between these two interfaces\nis that on this interface,", "start": 709.823, "duration": 2.617}, {"text": "all the responses come back\nencrypted with your key KC.", "start": 712.44, "duration": 3.73}, {"text": "And the Kerberos designers\nare a little worried", "start": 716.17, "duration": 3.33}, {"text": "about keeping this KC\naround for a long time.", "start": 719.5, "duration": 3.57}, {"text": "Because either you have to\nask the user to enter it,", "start": 723.07, "duration": 2.19}, {"text": "which is just\nannoying for the user,", "start": 725.26, "duration": 2.47}, {"text": "or it sits around in memory.", "start": 727.73, "duration": 1.6}, {"text": "And this is basically as\ngood as the user's password.", "start": 729.33, "duration": 3.07}, {"text": "So if this gets disclosed,\nthen someone with access to KC", "start": 732.4, "duration": 5.33}, {"text": "can keep accessing the user's\nfiles until the user maybe", "start": 737.73, "duration": 2.945}, {"text": "changes their password and\npotentially even longer.", "start": 740.675, "duration": 2.125}, {"text": "We'll see about that.", "start": 742.8, "duration": 2.5}, {"text": "So this KC is a really\ndangerous thing to leak.", "start": 745.3, "duration": 3.27}, {"text": "So the whole point of using\nthis interface first and using", "start": 748.57, "duration": 3.01}, {"text": "this interface later for\nall subsequent requests", "start": 751.58, "duration": 2.69}, {"text": "is that you can\nactually forget KC", "start": 754.27, "duration": 2.52}, {"text": "as soon as you decrypt this\nTGS response from the Kerberos", "start": 756.79, "duration": 3.64}, {"text": "interface.", "start": 760.43, "duration": 1.55}, {"text": "And from that point on,\neven if you leak it,", "start": 761.98, "duration": 2.62}, {"text": "there is a lifetime\nassociated with this ticket.", "start": 764.6, "duration": 2.394}, {"text": "So worst case,\nsomeone gets access", "start": 766.994, "duration": 1.416}, {"text": "to your account for\na couple of hours,", "start": 768.41, "duration": 1.75}, {"text": "not for an unbounded\namount of time.", "start": 770.16, "duration": 3.199}, {"text": "So that's the sort\nof main difference", "start": 773.359, "duration": 1.541}, {"text": "why you guys have this slightly\nmore complicated picture", "start": 774.9, "duration": 4.12}, {"text": "with two ways of\naccessing the same thing.", "start": 779.02, "duration": 4.17}, {"text": "All right, so before we dive\ninto the mechanics of how", "start": 783.19, "duration": 3.17}, {"text": "these protocols actually\nlook like on the wire,", "start": 786.36, "duration": 2.54}, {"text": "let's talk a little bit about\nthis naming aspect in Kerberos,", "start": 788.9, "duration": 4.16}, {"text": "right?", "start": 793.06, "duration": 0.5}, {"text": "So at some level, you\ncould think of Kerberos", "start": 793.56, "duration": 2.54}, {"text": "as being a name registry, right?", "start": 796.1, "duration": 2.43}, {"text": "So it's really\nresponsible for mapping", "start": 798.53, "duration": 2.15}, {"text": "these cryptographic\nkeys onto string names.", "start": 800.68, "duration": 3.41}, {"text": "And this is the fundamental\nsort of operation", "start": 804.09, "duration": 3.369}, {"text": "that Kerberos needs to provide.", "start": 807.459, "duration": 1.291}, {"text": "In fact, you'll see in the\nnext lecture even on the web,", "start": 808.75, "duration": 2.717}, {"text": "we need some function like this.", "start": 811.467, "duration": 1.333}, {"text": "It's implemented\ndifferently from Kerberos", "start": 812.8, "duration": 1.75}, {"text": "but this is a fundamentally\nvery important thing", "start": 814.55, "duration": 2.02}, {"text": "to have in almost any\ndistributed system", "start": 816.57, "duration": 2.49}, {"text": "for security.", "start": 819.06, "duration": 1.45}, {"text": "So let's look at how Kerberos\nactually deals with names.", "start": 820.51, "duration": 4.57}, {"text": "So in Kerberos,\nthe sort of system", "start": 825.08, "duration": 4.36}, {"text": "calls every entity in\nthis database a principal", "start": 829.44, "duration": 4.12}, {"text": "And a principal in Kerberos is\nactually just a string, right?", "start": 833.56, "duration": 3.36}, {"text": "So you can actually have some\nprincipal like, I don't know,", "start": 836.92, "duration": 2.86}, {"text": "nickolei.", "start": 839.78, "duration": 1.105}, {"text": "So that's a string.", "start": 840.885, "duration": 0.835}, {"text": "And that could be a principal\nin some Kerberos realm.", "start": 841.72, "duration": 3.45}, {"text": "So it would literally\nbe the thing", "start": 845.17, "duration": 1.68}, {"text": "that sits in this left\ncolumn of the KDC's table.", "start": 846.85, "duration": 5.15}, {"text": "And there's also\nsome extra instances", "start": 852.0, "duration": 4.007}, {"text": "that the protocl supports.", "start": 856.007, "duration": 1.083}, {"text": "I could say, you know,\nnikolai.extra secure", "start": 857.09, "duration": 3.11}, {"text": "or something.", "start": 860.2, "duration": 2.54}, {"text": "And I might use this\nas a different entity", "start": 862.74, "duration": 3.19}, {"text": "for machines I\nreally care about.", "start": 865.93, "duration": 2.03}, {"text": "So maybe I will have\na different password", "start": 867.96, "duration": 1.85}, {"text": "for really secure things\nand a different password", "start": 869.81, "duration": 2.13}, {"text": "for my regular account.", "start": 871.94, "duration": 2.18}, {"text": "So this is just sort\nof how Kerberos--", "start": 874.12, "duration": 2.99}, {"text": "this is what the paper\ntalks about with instances.", "start": 877.11, "duration": 3.58}, {"text": "So one might actually\nwonder-- where", "start": 880.69, "duration": 1.5}, {"text": "do you actually see instances?", "start": 882.19, "duration": 1.25}, {"text": "Where do influences come from?", "start": 883.44, "duration": 2.0}, {"text": "So the Kerberos service\nmaps names to keys for you,", "start": 885.44, "duration": 4.49}, {"text": "but how do you know\nwhich name to ask for", "start": 889.93, "duration": 2.01}, {"text": "or which name to expect when\nyou are talking to some machine?", "start": 891.94, "duration": 4.66}, {"text": "So I guess what I'm asking is,\nwhat are names appear outside", "start": 896.6, "duration": 4.12}, {"text": "of the Kerberos machine.", "start": 900.72, "duration": 2.33}, {"text": "So I guess we could ask, OK,\nwhere do user names appear?", "start": 903.05, "duration": 3.206}, {"text": "Any ideas?", "start": 906.256, "duration": 1.445}, {"text": "Yeah.", "start": 907.701, "duration": 0.499}, {"text": "STUDENT: You can ask the\nMIT server for usernames", "start": 908.2, "duration": 2.325}, {"text": "presumably.", "start": 910.525, "duration": 1.287}, {"text": "PROFESSOR: Right, yeah.", "start": 911.812, "duration": 0.958}, {"text": "So you could enumerate\nthese things.", "start": 912.77, "duration": 1.13}, {"text": "Also, the users just\ntype them in when", "start": 913.9, "duration": 1.45}, {"text": "they log into a machine.", "start": 915.35, "duration": 0.999}, {"text": "So that's where it\ninitially comes from.", "start": 916.349, "duration": 2.131}, {"text": "Do usernames appear\nanywhere else?", "start": 918.48, "duration": 2.54}, {"text": "Should they appear\nanywhere else?", "start": 921.02, "duration": 2.632}, {"text": "Yeah.", "start": 923.652, "duration": 0.5}, {"text": "STUDENT: Possibly\naccess the [INAUDIBLE]", "start": 924.152, "duration": 1.932}, {"text": "lists on the various services.", "start": 926.084, "duration": 1.41}, {"text": "PROFESSOR: Yes, that's actually\nan important point, right?", "start": 927.494, "duration": 2.416}, {"text": "The goal of Kerberos is\njust to map keys to names.", "start": 929.91, "duration": 3.94}, {"text": "But it doesn't tell you what\nthat name should have access", "start": 933.85, "duration": 2.59}, {"text": "to.", "start": 936.44, "duration": 0.58}, {"text": "In fact, the way the\napplications typically", "start": 937.02, "duration": 1.93}, {"text": "use Kerberos is that\none of these servers", "start": 938.95, "duration": 3.95}, {"text": "uses Kerberos to figure out,\nOK, what string name am I", "start": 942.9, "duration": 2.83}, {"text": "talking to?", "start": 945.73, "duration": 0.56}, {"text": "So when the mail server\ngets a connection", "start": 946.29, "duration": 2.0}, {"text": "from some workstation and it\nget the Kerberos ticket that", "start": 948.29, "duration": 2.63}, {"text": "prove that maybe this\nuser is called Nikolai,", "start": 950.92, "duration": 3.3}, {"text": "then the mail server\ninternally now", "start": 954.22, "duration": 1.89}, {"text": "has to figure out,\nOK, well, what", "start": 956.11, "duration": 1.52}, {"text": "should that guy have access to?", "start": 957.63, "duration": 1.65}, {"text": "And same for a file server.", "start": 959.28, "duration": 1.68}, {"text": "So inside of all\nthese servers, there's", "start": 960.96, "duration": 2.19}, {"text": "probably things like access\ncontrol lists, maybe groups,", "start": 963.15, "duration": 4.75}, {"text": "maybe other things that actually\ndo the authorization step.", "start": 967.9, "duration": 3.87}, {"text": "So Kerberos provides\nauthentication", "start": 971.77, "duration": 3.0}, {"text": "which tells you who is\nthis person I'm talking to.", "start": 974.77, "duration": 2.92}, {"text": "And the service itself is\nresponsible for implementing", "start": 977.69, "duration": 2.89}, {"text": "the authorization part where\nthey decide what access", "start": 980.58, "duration": 3.29}, {"text": "you should have based\non your username here.", "start": 983.87, "duration": 4.31}, {"text": "Makes sense?", "start": 988.18, "duration": 2.26}, {"text": "All right, so that's where\nthe user names appear.", "start": 990.44, "duration": 3.06}, {"text": "There's also other\nprincipal names", "start": 993.5, "duration": 1.6}, {"text": "the Kerberos supports\nfor services, right?", "start": 995.1, "duration": 2.3}, {"text": "So services, I guess\nthe paper suggests,", "start": 997.4, "duration": 2.49}, {"text": "look something like this.", "start": 999.89, "duration": 1.49}, {"text": "That's rcmd.hostname.", "start": 1001.38, "duration": 0.89}, {"text": "And the reason that you need a\nname for one of these services", "start": 1007.91, "duration": 5.679}, {"text": "is that you want to\nknow, for example, when", "start": 1013.589, "duration": 1.791}, {"text": "I connect to a file\nserver, I actually", "start": 1015.38, "duration": 3.6}, {"text": "want mutual authentication.", "start": 1018.98, "duration": 2.52}, {"text": "It's not just the final\nserver learns who I am,", "start": 1021.5, "duration": 2.66}, {"text": "but I, the user or\nthe workstation,", "start": 1024.16, "duration": 2.128}, {"text": "want to be convinced that\nI'm talking to the right file", "start": 1026.288, "duration": 2.291}, {"text": "server and not some\nfake file server that's", "start": 1028.579, "duration": 2.02}, {"text": "impersonating my files.", "start": 1030.599, "duration": 1.281}, {"text": "Because maybe I'll\nlook at the grades", "start": 1031.88, "duration": 2.229}, {"text": "file and submit it\nto the registrar.", "start": 1034.109, "duration": 1.581}, {"text": "It would be too bad\nif some file server", "start": 1035.69, "duration": 2.274}, {"text": "can impersonate the response and\ngive me the wrong grades file", "start": 1037.964, "duration": 3.355}, {"text": "all of a sudden.", "start": 1041.319, "duration": 1.701}, {"text": "So this is why the\nservice principles also", "start": 1043.02, "duration": 2.48}, {"text": "need their own name and the\nworkstations need to figure out", "start": 1045.5, "duration": 4.27}, {"text": "what name should I expect to see\nwhen I connect to the service.", "start": 1049.77, "duration": 4.35}, {"text": "And typically, this comes\nfrom the user at some level.", "start": 1054.12, "duration": 2.38}, {"text": "So for example, if I type\nSSH some machine foo,", "start": 1056.5, "duration": 4.51}, {"text": "then this means that\nI should be expecting", "start": 1061.01, "duration": 3.14}, {"text": "a Kerberos principal\ncalled rcmd.foo", "start": 1064.15, "duration": 2.95}, {"text": "on the other end\nof this connection.", "start": 1067.1, "duration": 1.9}, {"text": "And if it turns out\nto be someone else,", "start": 1069.0, "duration": 2.21}, {"text": "this SSH client\nshould abort and not", "start": 1071.21, "duration": 2.03}, {"text": "let me connect because then\nI will be misled into talking", "start": 1073.24, "duration": 2.8}, {"text": "to some other machine.", "start": 1076.04, "duration": 1.896}, {"text": "That make sense?", "start": 1077.936, "duration": 2.456}, {"text": "So here's one\ninteresting question.", "start": 1080.392, "duration": 1.458}, {"text": "When can we reuse\nnames in Kerberos?", "start": 1081.85, "duration": 2.515}, {"text": "It's like, all of you\nguys have Athena accounts.", "start": 1084.365, "duration": 2.575}, {"text": "And when you\ngraduate, could MIT,", "start": 1086.94, "duration": 2.02}, {"text": "like, wipe out\nyour database entry", "start": 1088.96, "duration": 2.52}, {"text": "and allow someone else to\nregister that same username?", "start": 1091.48, "duration": 2.65}, {"text": "Would that be a good idea?", "start": 1094.13, "duration": 2.47}, {"text": "Well, aside from the fact\nthat you guys want accounts.", "start": 1096.6, "duration": 2.69}, {"text": "Yeah.", "start": 1099.29, "duration": 0.5}, {"text": "STUDENT: Updated services\nas well so that they would,", "start": 1099.79, "duration": 3.415}, {"text": "like map that username\nto [INAUDIBLE] permission", "start": 1103.205, "duration": 2.388}, {"text": "theoretically?", "start": 1105.593, "duration": 0.583}, {"text": "PROFESSOR: Yeah, because\nthese guys are actually", "start": 1106.176, "duration": 2.294}, {"text": "just string entries somewhere\nin some ACL on a file", "start": 1108.47, "duration": 4.11}, {"text": "server on a mail server.", "start": 1112.58, "duration": 1.37}, {"text": "And just because you wipe out\nthis entry in the Kerberos", "start": 1113.95, "duration": 3.39}, {"text": "database doesn't mean\nthat this entry is gone.", "start": 1117.34, "duration": 2.735}, {"text": "And they're not versioning\nin any way, right?", "start": 1120.075, "duration": 1.875}, {"text": "This entry could\nliterally say, you know,", "start": 1121.95, "duration": 1.708}, {"text": "Alice has access to\nsome Athena locker.", "start": 1123.658, "duration": 3.612}, {"text": "And if this Alice graduates\nand her entry gets removed,", "start": 1127.27, "duration": 3.729}, {"text": "then some new Alice\ncomes along, registers,", "start": 1130.999, "duration": 1.791}, {"text": "in the Kerberos database.", "start": 1132.79, "duration": 1.98}, {"text": "But she gets a\nprincipal that looks", "start": 1134.77, "duration": 1.8}, {"text": "identical to the old Alice.", "start": 1136.57, "duration": 1.325}, {"text": "It's the same string.", "start": 1137.895, "duration": 0.875}, {"text": "So all of a sudden,\nthe file server", "start": 1138.77, "duration": 1.6}, {"text": "will give access to the new\nAlice to old Alice's data.", "start": 1140.37, "duration": 4.37}, {"text": "So there's a bit of\na complicated process", "start": 1144.74, "duration": 1.88}, {"text": "for reclaiming principal\nnames in Kerberos", "start": 1146.62, "duration": 3.03}, {"text": "because there's\nno real connection", "start": 1149.65, "duration": 1.51}, {"text": "or versioning\nbetween these guys.", "start": 1151.16, "duration": 1.709}, {"text": "So as a result, it's\nactually kind of", "start": 1152.869, "duration": 1.541}, {"text": "hard to reuse principal names.", "start": 1154.41, "duration": 2.339}, {"text": "Once you register a\nprincipal, you probably", "start": 1156.749, "duration": 1.791}, {"text": "don't want to reuse\nit very often.", "start": 1158.54, "duration": 3.62}, {"text": "And same for, in some\nsense, these principal names", "start": 1162.16, "duration": 3.77}, {"text": "for service as well.", "start": 1165.93, "duration": 1.09}, {"text": "As long as this hostname\nremain some well-known service", "start": 1167.02, "duration": 3.89}, {"text": "that people expect to\nfunction in a certain way,", "start": 1170.91, "duration": 2.13}, {"text": "you probably don't want\nto get rid of its key", "start": 1173.04, "duration": 1.88}, {"text": "even if the service goes on.", "start": 1174.92, "duration": 1.02}, {"text": "Because maybe a year later,\nsome guy tries to connect to it", "start": 1175.94, "duration": 2.458}, {"text": "and expects certain things.", "start": 1178.398, "duration": 1.183}, {"text": "And if it's been reused\nfor a different service,", "start": 1179.581, "duration": 1.999}, {"text": "that guy can impersonate things.", "start": 1181.58, "duration": 2.55}, {"text": "Probably not as dramatic\nor as bad, but still,", "start": 1184.13, "duration": 3.49}, {"text": "you have to be careful with\nreusing principal names", "start": 1187.62, "duration": 2.8}, {"text": "in this kind of protocol.", "start": 1190.42, "duration": 2.49}, {"text": "Makes sense?", "start": 1192.91, "duration": 1.03}, {"text": "Any questions?", "start": 1193.94, "duration": 2.2}, {"text": "All right, so let's look at how\nthe protocol itself now works.", "start": 1196.14, "duration": 3.45}, {"text": "So we'll look first and\nthis step of the protocol", "start": 1199.59, "duration": 3.19}, {"text": "where you initially get your\nticket with your password.", "start": 1202.78, "duration": 3.38}, {"text": "And then we'll look at how\nthis TGS interface works", "start": 1206.16, "duration": 3.01}, {"text": "and how it differs\nthen a little bit.", "start": 1209.17, "duration": 3.49}, {"text": "All right, so I guess\nthere's this main data", "start": 1212.66, "duration": 2.62}, {"text": "structure that Kerberos\nuses called a ticket.", "start": 1215.28, "duration": 2.51}, {"text": "And this ticket looks like this.", "start": 1217.79, "duration": 3.87}, {"text": "So there's a ticket to\nbetween a client and a server.", "start": 1221.66, "duration": 3.61}, {"text": "And this guy is\nbasically the names", "start": 1225.27, "duration": 3.24}, {"text": "of the server and\nthe client that we're", "start": 1228.51, "duration": 2.04}, {"text": "talking about-- the IP\naddress of the client,", "start": 1230.55, "duration": 5.64}, {"text": "some kind of timestamp, and an\nexpiration time for how long", "start": 1236.19, "duration": 6.86}, {"text": "the stick is valid.", "start": 1243.05, "duration": 1.21}, {"text": "And there's also\na key, KCS, that's", "start": 1244.26, "duration": 4.14}, {"text": "going to be shared between\nthe client and the server.", "start": 1248.4, "duration": 3.46}, {"text": "So that's what's in a ticket.", "start": 1251.86, "duration": 1.93}, {"text": "And there's also this\nother weird data structure", "start": 1253.79, "duration": 2.82}, {"text": "that Kerberos introduces\ncalled an authenticator.", "start": 1256.61, "duration": 2.77}, {"text": "And an authenticator goes\nwith a particular client C.", "start": 1259.38, "duration": 4.21}, {"text": "And this thing is just\nthe client's name,", "start": 1263.59, "duration": 2.94}, {"text": "the IP address of the\nclient, and the time stamp", "start": 1266.53, "duration": 5.11}, {"text": "when the client generated\nthis authenticator.", "start": 1271.64, "duration": 3.57}, {"text": "And typically, both of\nthese things are encrypted.", "start": 1275.21, "duration": 3.06}, {"text": "And authenticator is\ntypically scripted", "start": 1278.27, "duration": 2.25}, {"text": "with the key between the\nclient on the server.", "start": 1280.52, "duration": 3.24}, {"text": "So the authenticator\nsort of has to do", "start": 1283.76, "duration": 1.91}, {"text": "with a particular connection\nbetween a client and a server.", "start": 1285.67, "duration": 3.44}, {"text": "And the Kerberos\nticket itself here", "start": 1289.11, "duration": 2.44}, {"text": "is typically encrypted with\nthe key for the service KS.", "start": 1291.55, "duration": 6.59}, {"text": "So the subscript\nnotation denotes here", "start": 1298.14, "duration": 2.87}, {"text": "encryption with\na particular key.", "start": 1301.01, "duration": 4.04}, {"text": "All right, so what does this--\nso using this sort of notation", "start": 1305.05, "duration": 3.42}, {"text": "here, let's try to figure\nout what is the protocol.", "start": 1308.47, "duration": 2.2}, {"text": "By which the user initially\nlogs into this Kerberos", "start": 1310.67, "duration": 2.98}, {"text": "and gets their TGS ticket.", "start": 1313.65, "duration": 2.36}, {"text": "So as we saw here\nbefore, right, the plan", "start": 1316.01, "duration": 3.23}, {"text": "is the client is going to\nsend their username over", "start": 1319.24, "duration": 6.79}, {"text": "to the Kerberos server\nor that interface.", "start": 1326.03, "duration": 4.1}, {"text": "And the response is\ngoing to be a ticket.", "start": 1330.13, "duration": 2.01}, {"text": "And what precisely\nthe client actually", "start": 1332.14, "duration": 1.62}, {"text": "sends over-- both the username\nC of the client that's", "start": 1333.76, "duration": 3.95}, {"text": "issuing the request as well\nas the principal name-- well,", "start": 1337.71, "duration": 4.44}, {"text": "the client is also\na principal name.", "start": 1342.15, "duration": 1.61}, {"text": "But the client also\nsends the principal name", "start": 1343.76, "duration": 2.08}, {"text": "of the service for which it\nwould like to get a ticket.", "start": 1345.84, "duration": 3.88}, {"text": "And typically, the service name\nis actually the service name", "start": 1349.72, "duration": 3.16}, {"text": "of this TGS guy over here.", "start": 1352.88, "duration": 1.82}, {"text": "So you get a ticket for them.", "start": 1354.7, "duration": 1.45}, {"text": "But you could get a ticket\nfor almost any service", "start": 1356.15, "duration": 2.041}, {"text": "you want in this way.", "start": 1358.191, "duration": 1.509}, {"text": "And their response\nis going to be", "start": 1359.7, "duration": 2.73}, {"text": "this sort of interesting tuple.", "start": 1362.43, "duration": 1.95}, {"text": "It's going to be your\nticket between the client", "start": 1364.38, "duration": 2.65}, {"text": "and the server encrypted\njust with that key KS", "start": 1367.03, "duration": 3.9}, {"text": "as shown above.", "start": 1370.93, "duration": 2.63}, {"text": "I guess we should\nwrite that down with KS", "start": 1373.56, "duration": 2.61}, {"text": "And also, you get to\nthis shared key-- key CS.", "start": 1376.17, "duration": 4.97}, {"text": "And this whole thing\nis encrypted with KC.", "start": 1381.14, "duration": 5.04}, {"text": "So that's the wire protocol.", "start": 1386.18, "duration": 2.51}, {"text": "So I guess let's try to\nfigure out a couple things.", "start": 1388.69, "duration": 2.5}, {"text": "So first of all, how\ndoes the Kerberos server", "start": 1391.19, "duration": 6.58}, {"text": "authenticate the client here?", "start": 1397.77, "duration": 1.25}, {"text": "How does it know that this\nis the right user making", "start": 1399.02, "duration": 1.89}, {"text": "this request?", "start": 1400.91, "duration": 0.541}, {"text": "Yeah.", "start": 1404.395, "duration": 0.5}, {"text": "STUDENT: It can make\nsure that the ticket", "start": 1404.895, "duration": 2.233}, {"text": "that it sent because it has KC.", "start": 1407.128, "duration": 1.972}, {"text": "PROFESSOR: Yes, I think\nthat's what's going on", "start": 1409.1, "duration": 1.92}, {"text": "is that the Kerberos server\nagain on some level actually", "start": 1411.02, "duration": 1.94}, {"text": "doesn't know whether this\nis the right client or not.", "start": 1412.96, "duration": 2.58}, {"text": "But it thinks oh, well,\nsure, it doesn't matter", "start": 1415.54, "duration": 1.96}, {"text": "who is making this request.", "start": 1417.5, "duration": 1.43}, {"text": "I'll just send this blob\nout and the only person", "start": 1418.93, "duration": 2.85}, {"text": "who should be able to\nmake any use of this blob", "start": 1421.78, "duration": 2.23}, {"text": "is the person that knows\nthis key KC over here.", "start": 1424.01, "duration": 4.16}, {"text": "So that's actually kind\nof cool because the client", "start": 1428.17, "duration": 2.262}, {"text": "doesn't have to\nsend their password", "start": 1430.432, "duration": 1.458}, {"text": "over the network at all.", "start": 1431.89, "duration": 1.9}, {"text": "So in some ways, this is\nactually better than the client", "start": 1433.79, "duration": 2.86}, {"text": "sending a password to\nthe Kerberos server", "start": 1436.65, "duration": 2.15}, {"text": "because even if the\nKerberos server here", "start": 1438.8, "duration": 2.91}, {"text": "was listening for\nthese passwords", "start": 1441.71, "duration": 2.25}, {"text": "and trying to record them, it\nwould never get your password.", "start": 1443.96, "duration": 2.75}, {"text": "Or maybe if someone was\nimpersonating the Kerberos", "start": 1446.71, "duration": 2.19}, {"text": "server, they wouldn't get\na copy of your password.", "start": 1448.9, "duration": 4.1}, {"text": "All right, yeah.", "start": 1453.0, "duration": 1.09}, {"text": "STUDENT: [INAUDIBLE]\nadversary wants to [INAUDIBLE]", "start": 1454.09, "duration": 3.29}, {"text": "your password offline without--", "start": 1457.38, "duration": 2.82}, {"text": "PROFESSOR: Yeah, so this is\nactually not a great aspect", "start": 1460.2, "duration": 2.82}, {"text": "of Kerberos, in fact, right?", "start": 1463.02, "duration": 1.302}, {"text": "So does everyone see\nwhat the problem is?", "start": 1464.322, "duration": 1.708}, {"text": "The problem is that the\nway the client could", "start": 1466.03, "duration": 2.4}, {"text": "tell if they got the\nright password or not", "start": 1468.43, "duration": 1.75}, {"text": "or the workstation tells\nif the client supplied", "start": 1470.18, "duration": 2.34}, {"text": "the right password is they\ntry to decrypt this ticket", "start": 1472.52, "duration": 2.8}, {"text": "and they see if it works or not.", "start": 1475.32, "duration": 2.44}, {"text": "And decryption is fairly cheap.", "start": 1477.76, "duration": 3.32}, {"text": "This is symmetric\nencryption and you", "start": 1481.08, "duration": 1.62}, {"text": "can do probably\nmillions of decryptions", "start": 1482.7, "duration": 2.36}, {"text": "a second if you try\nhard on modern machines.", "start": 1485.06, "duration": 4.4}, {"text": "And this means that\nyou can try millions", "start": 1489.46, "duration": 2.84}, {"text": "of potential\npasswords per second", "start": 1492.3, "duration": 1.72}, {"text": "to guess what the\nperson's password is.", "start": 1494.02, "duration": 2.477}, {"text": "And you could do this\nfor any person at all.", "start": 1496.497, "duration": 1.833}, {"text": "You could just send\ntheir principal", "start": 1498.33, "duration": 2.042}, {"text": "to the Kerberos server.", "start": 1500.372, "duration": 0.958}, {"text": "It'll very happily give you\nback this response encrypted", "start": 1501.33, "duration": 2.669}, {"text": "with the user's password.", "start": 1503.999, "duration": 1.041}, {"text": "Then you can just try different\npasswords and just see what", "start": 1505.04, "duration": 2.55}, {"text": "works or what doesn't.", "start": 1507.59, "duration": 1.15}, {"text": "Yeah.", "start": 1508.74, "duration": 1.058}, {"text": "STUDENT: But won't the\ncontent [INAUDIBLE]", "start": 1509.798, "duration": 2.988}, {"text": "decrypted [INAUDIBLE] advantage?", "start": 1512.786, "duration": 1.992}, {"text": "How can we be sure\nthat you directly--", "start": 1514.778, "duration": 1.974}, {"text": "PROFESSOR: Yes, this is actually\nanother interesting aspect", "start": 1516.752, "duration": 2.458}, {"text": "where the Kerberos 4\ndevelopers didn't quite", "start": 1519.21, "duration": 2.15}, {"text": "realize that the time they were\nbuilding this that they really", "start": 1521.36, "duration": 2.94}, {"text": "should have been very careful\nabout separating encryption", "start": 1524.3, "duration": 2.97}, {"text": "from authentication.", "start": 1527.27, "duration": 1.84}, {"text": "So in the paper, there's\nthis implicit assumption", "start": 1529.11, "duration": 4.04}, {"text": "that-- hopefully, that's not us.", "start": 1533.15, "duration": 4.292}, {"text": "All right, sorry.", "start": 1537.442, "duration": 0.708}, {"text": "So in the paper, there's\nthis implicit assumption", "start": 1538.15, "duration": 2.041}, {"text": "that whenever you\nencrypt a piece of data", "start": 1540.191, "duration": 3.029}, {"text": "and you send it to someone\nelse, if that person can decrypt", "start": 1543.22, "duration": 2.99}, {"text": "the data and it\nsort of looks OK,", "start": 1546.21, "duration": 2.14}, {"text": "then no, they must have\ngotten the right key", "start": 1548.35, "duration": 1.86}, {"text": "and the data wasn't\ntampered with in flight.", "start": 1550.21, "duration": 2.31}, {"text": "But it seems like a\ntotally bad plan now", "start": 1552.52, "duration": 1.91}, {"text": "that we think of\nit 30 years later.", "start": 1554.43, "duration": 2.16}, {"text": "But at the time,\nit wasn't so clear.", "start": 1556.59, "duration": 1.64}, {"text": "So in order to do\nKerberos right,", "start": 1558.23, "duration": 1.38}, {"text": "and in fact, what\nKerberos 5 does now,", "start": 1559.61, "duration": 2.12}, {"text": "is they both encrypt\nall the pieces of data", "start": 1561.73, "duration": 2.547}, {"text": "and they also\nauthenticate the message", "start": 1564.277, "duration": 1.583}, {"text": "by basically computing\na hash with a key.", "start": 1565.86, "duration": 3.49}, {"text": "And then the result\nactually tells you", "start": 1569.35, "duration": 1.97}, {"text": "that, oh, that piece of data\njust wasn't tampered with.", "start": 1571.32, "duration": 2.64}, {"text": "It was correctly signed\nwith this key, et cetera.", "start": 1573.96, "duration": 2.429}, {"text": "And what actually\nhappens in Kerberos", "start": 1576.389, "duration": 1.541}, {"text": "version 4 is there\nare some extra bits", "start": 1577.93, "duration": 2.1}, {"text": "in this thing that was\nencrypted that should all", "start": 1580.03, "duration": 3.08}, {"text": "be some pattern like zeros.", "start": 1583.11, "duration": 2.24}, {"text": "And typically, if you\nget the key wrong,", "start": 1585.35, "duration": 2.8}, {"text": "that pattern will not look\nlike all zeros just by chance.", "start": 1588.15, "duration": 3.36}, {"text": "It's not cryptographically\nguaranteed to be that.", "start": 1591.51, "duration": 2.7}, {"text": "But most times, it will\nnot look like zeros", "start": 1594.21, "duration": 2.48}, {"text": "and you will be able to decide\nwhether you got the correct key", "start": 1596.69, "duration": 3.34}, {"text": "or not.", "start": 1600.03, "duration": 2.46}, {"text": "All right, so that's\nsort of the plan", "start": 1602.49, "duration": 2.91}, {"text": "for how the clients\ntells, I guess,", "start": 1605.4, "duration": 2.344}, {"text": "whether the ticket is valid.", "start": 1607.744, "duration": 1.166}, {"text": "They just try to decrypt\nit and see how it works.", "start": 1608.91, "duration": 3.474}, {"text": "So another interesting\nquestion is", "start": 1612.384, "duration": 1.416}, {"text": "why is this key\nKCS included twice", "start": 1613.8, "duration": 3.414}, {"text": "in the ticket in\nsome form, right?", "start": 1617.214, "duration": 1.416}, {"text": "So it's included once here\nand another time actually sort", "start": 1618.63, "duration": 3.89}, {"text": "of implicitly in\nthis ticket T. Why", "start": 1622.52, "duration": 3.54}, {"text": "do we have two copies\nof the same key KCS?", "start": 1626.06, "duration": 4.214}, {"text": "Yeah.", "start": 1630.274, "duration": 0.5}, {"text": "STUDENT: The client\ncan't decrypt that ticket", "start": 1630.774, "duration": 1.884}, {"text": "because it's encrypted\nwith a service key.", "start": 1632.658, "duration": 2.023}, {"text": "PROFESSOR: Yeah, so it's\nactually kind of cute, right?", "start": 1634.681, "duration": 2.249}, {"text": "Like, there's this key\nthat the client can get to.", "start": 1636.93, "duration": 2.137}, {"text": "But then there's another\ncopy of it in here.", "start": 1639.067, "duration": 1.833}, {"text": "It's encrypted with KS.", "start": 1640.9, "duration": 2.4}, {"text": "And the reason for this is that\nthe Kerberos server is actually", "start": 1643.3, "duration": 4.1}, {"text": "trying to set up the\nclient and this other guy", "start": 1647.4, "duration": 2.27}, {"text": "to talk to each other securely.", "start": 1649.67, "duration": 1.68}, {"text": "So the Kerberos generates\nthis hopefully random key KCS", "start": 1651.35, "duration": 4.3}, {"text": "and wants to give one copy\nto the client and one copy", "start": 1655.65, "duration": 2.53}, {"text": "to the write other server\nthat you want to talk to.", "start": 1658.18, "duration": 2.46}, {"text": "And one thing you could\nimagine doing naively", "start": 1660.64, "duration": 2.2}, {"text": "is maybe the Kerberos will\njust go and say, hey service,", "start": 1662.84, "duration": 2.76}, {"text": "this guy wants to talk to you.", "start": 1665.6, "duration": 1.25}, {"text": "Here's the key for it.", "start": 1666.85, "duration": 0.917}, {"text": "But that would be\nkind of unfortunate.", "start": 1667.767, "duration": 1.582}, {"text": "You'd have to have the Kerberos\nserver call back to the service", "start": 1669.349, "duration": 3.031}, {"text": "and so on.", "start": 1672.38, "duration": 1.0}, {"text": "So instead, these guys have\nthis nice trick where they just", "start": 1673.38, "duration": 3.23}, {"text": "to give the client does\nblob that the client", "start": 1676.61, "duration": 2.289}, {"text": "can't actually do\nanything with other", "start": 1678.899, "duration": 1.541}, {"text": "than give to the right service.", "start": 1680.44, "duration": 1.85}, {"text": "And if the service\nhas the right key KS,", "start": 1682.29, "duration": 2.18}, {"text": "they'll decrypt it and say, aha.", "start": 1684.47, "duration": 1.79}, {"text": "Well, here's the key I should be\nusing to speak to this client.", "start": 1686.26, "duration": 4.16}, {"text": "And that's how these two guys,\nthe client and the service,", "start": 1690.42, "duration": 3.55}, {"text": "are going to establish a\nshared key for protecting", "start": 1693.97, "duration": 2.35}, {"text": "their communication.", "start": 1696.32, "duration": 0.88}, {"text": "Yeah.", "start": 1697.2, "duration": 0.5}, {"text": "STUDENT: So what exactly is TGS?", "start": 1697.7, "duration": 1.97}, {"text": "PROFESSOR: So TGS\nis-- OK, so there's", "start": 1699.67, "duration": 4.49}, {"text": "sort of two sides to it.", "start": 1704.16, "duration": 1.66}, {"text": "From the client's point of\nview, it's just another service", "start": 1705.82, "duration": 2.8}, {"text": "that you can get a ticket for.", "start": 1708.62, "duration": 1.67}, {"text": "And the kinds of\noperations it supports", "start": 1710.29, "duration": 2.25}, {"text": "is getting more tickets.", "start": 1712.54, "duration": 1.15}, {"text": "It's a Ticket Granting Service.", "start": 1713.69, "duration": 1.32}, {"text": "STUDENT: Sorry, I meant what\nis the ticket called TGS.", "start": 1715.01, "duration": 2.3}, {"text": "PROFESSOR: Oh, yeah, sorry.", "start": 1717.31, "duration": 1.21}, {"text": "This TGS is just shorthand\nfor this whole blob", "start": 1718.52, "duration": 3.24}, {"text": "except where S is actually\nthe principal name of this TGS", "start": 1721.76, "duration": 3.805}, {"text": "service.", "start": 1725.565, "duration": 0.5}, {"text": "So you can think of it as\nlike, well, there's a Kerberos", "start": 1728.527, "duration": 2.333}, {"text": "server, there's this\nTGS service out there,", "start": 1730.86, "duration": 1.91}, {"text": "and then there's the real\nthing I want to get to.", "start": 1732.77, "duration": 1.46}, {"text": "So you first ask\nthis guy to give me", "start": 1734.23, "duration": 1.94}, {"text": "a ticket for some service.", "start": 1736.17, "duration": 1.78}, {"text": "You could ask it to give you\ndirectly a ticket for the file", "start": 1737.95, "duration": 2.58}, {"text": "server.", "start": 1740.53, "duration": 1.02}, {"text": "And this would work.", "start": 1741.55, "duration": 0.85}, {"text": "But you'd need your\nKC to decrypt it", "start": 1742.4, "duration": 1.64}, {"text": "and then you'd need your\nKC around all the time.", "start": 1744.04, "duration": 2.004}, {"text": "So instead, what\nyou do is you get", "start": 1746.044, "duration": 1.416}, {"text": "a ticket for this special\nservice over here.", "start": 1747.46, "duration": 3.135}, {"text": "It looks just like a service\nexcept that it happens", "start": 1750.595, "duration": 2.125}, {"text": "to be provided by the same box.", "start": 1752.72, "duration": 2.91}, {"text": "And then this guy will\nhappily give you more tickets", "start": 1755.63, "duration": 2.68}, {"text": "later without having to\npresent your initial KC again.", "start": 1758.31, "duration": 4.9}, {"text": "Makes sense?", "start": 1763.21, "duration": 0.933}, {"text": "All right, other questions?", "start": 1764.143, "duration": 2.687}, {"text": "Yeah.", "start": 1766.83, "duration": 0.832}, {"text": "STUDENT: So [INAUDIBLE] the idea\nis once you get the TGS ticket,", "start": 1767.662, "duration": 4.82}, {"text": "you can just get rid of your KC?", "start": 1772.482, "duration": 1.458}, {"text": "PROFESSOR: Yes,\nso that's actually", "start": 1773.94, "duration": 0.9}, {"text": "the cool thing about\nit is that once", "start": 1774.84, "duration": 1.82}, {"text": "you get this ticket-- well, this\nticket with the S being TGS,", "start": 1776.66, "duration": 3.59}, {"text": "then you're going to get\nrid of the password and KC.", "start": 1780.25, "duration": 3.2}, {"text": "So you log into Athena\nworkstation and a couple", "start": 1783.45, "duration": 3.386}, {"text": "of seconds into\nthe boot process,", "start": 1786.836, "duration": 1.374}, {"text": "you already get\nyour ticket here.", "start": 1788.21, "duration": 1.374}, {"text": "It scrubs the\npassword from memory.", "start": 1789.584, "duration": 1.696}, {"text": "So even if someone, like,\ngrabs you and grab the machine", "start": 1791.28, "duration": 2.96}, {"text": "and runs off, all they\ngot was your ticket.", "start": 1794.24, "duration": 2.63}, {"text": "And OK, well, maybe they can\naccess your stuff for 10 hours", "start": 1796.87, "duration": 2.96}, {"text": "or whatever the\nticket lifetime was,", "start": 1799.83, "duration": 1.58}, {"text": "but not for longer than that.", "start": 1801.41, "duration": 1.35}, {"text": "The password is gone.", "start": 1802.76, "duration": 2.82}, {"text": "Yeah.", "start": 1805.58, "duration": 0.5}, {"text": "So if the password's\ngone, then on that picture", "start": 1806.08, "duration": 2.832}, {"text": "there when Kerberos\nsends a reply", "start": 1808.912, "duration": 2.088}, {"text": "encrypted with KC,\nhow does the client--", "start": 1811.0, "duration": 3.22}, {"text": "Oh yeah, so this is the one\nplace you need your password.", "start": 1814.22, "duration": 2.46}, {"text": "So you send this message,\nyou get this reply,", "start": 1816.68, "duration": 2.97}, {"text": "you decrypt this, and then\nyou forget the password.", "start": 1819.65, "duration": 2.953}, {"text": "So you can't forget\nabout the password", "start": 1822.603, "duration": 1.583}, {"text": "before you use it for\ndecryption of course.", "start": 1824.186, "duration": 2.034}, {"text": "STUDENT: [INAUDIBLE]", "start": 1826.22, "duration": 1.93}, {"text": "PROFESSOR: Ah, no, so this is\njust this interface, right?", "start": 1828.15, "duration": 2.44}, {"text": "So this is the thing\nyou do initially.", "start": 1830.59, "duration": 2.88}, {"text": "And we'll talk in a second\nabout how you basically also", "start": 1833.47, "duration": 2.75}, {"text": "can get any ticket you want\nfrom the second interface", "start": 1836.22, "duration": 2.62}, {"text": "without needing\nthe initial key KC.", "start": 1838.84, "duration": 5.084}, {"text": "Right, make sense?", "start": 1843.924, "duration": 2.836}, {"text": "All right, so I guess\nwe already talked", "start": 1846.76, "duration": 2.77}, {"text": "about two particular problems\nthat the Kerberos protocol had", "start": 1849.53, "duration": 4.39}, {"text": "sort of baked into it, which\nis a little unfortunate.", "start": 1853.92, "duration": 2.91}, {"text": "One is that they assumed\nthat encryption also", "start": 1856.83, "duration": 2.69}, {"text": "provides authentication\nor integrity of messages.", "start": 1859.52, "duration": 2.92}, {"text": "So don't do that.", "start": 1862.44, "duration": 0.83}, {"text": "And Kerberos\nversion 5 fixes this", "start": 1863.27, "duration": 1.77}, {"text": "by explicitly\nauthenticating messages.", "start": 1865.04, "duration": 2.73}, {"text": "Another thing they sort\nof had a problem with", "start": 1867.77, "duration": 4.17}, {"text": "is the ability for\narbitrary clients", "start": 1871.94, "duration": 2.88}, {"text": "to guess people's passwords.", "start": 1874.82, "duration": 2.4}, {"text": "So any suggestions of\nhow we could fix this?", "start": 1877.22, "duration": 3.882}, {"text": "How do you prevent\nguessing attacks", "start": 1881.102, "duration": 1.458}, {"text": "in a protocol like this?", "start": 1882.56, "duration": 2.266}, {"text": "What could we try?", "start": 1884.826, "duration": 1.416}, {"text": "Yeah.", "start": 1886.242, "duration": 0.533}, {"text": "STUDENT: Some sort of salting?", "start": 1886.775, "duration": 1.249}, {"text": "I'm not sure.", "start": 1888.024, "duration": 1.376}, {"text": "PROFESSOR: Well, so\nsalting would just", "start": 1889.4, "duration": 2.14}, {"text": "means that the client\nhas to hash the password", "start": 1891.54, "duration": 2.36}, {"text": "in different ways, maybe.", "start": 1893.9, "duration": 1.166}, {"text": "But it still\ndoesn't prevent them", "start": 1895.066, "duration": 1.374}, {"text": "from trying lots of things.", "start": 1896.44, "duration": 1.219}, {"text": "So maybe it'll be more\nexpensive to build a dictionary.", "start": 1897.659, "duration": 2.291}, {"text": "Yeah.", "start": 1899.95, "duration": 0.499}, {"text": "STUDENT: You could [INAUDIBLE]\nderivation function?", "start": 1900.449, "duration": 2.66}, {"text": "PROFESSOR: Yeah, so\nanother good idea", "start": 1903.109, "duration": 1.541}, {"text": "is to make this hashing\nprocess super expensive.", "start": 1904.65, "duration": 3.299}, {"text": "So that might be\nkind of nice, right?", "start": 1907.949, "duration": 1.541}, {"text": "So if this hash function took\na second to compute like you", "start": 1909.49, "duration": 3.16}, {"text": "guys did in lab two,\nthen OK, wow, this", "start": 1912.65, "duration": 1.754}, {"text": "would be actually\nreally expensive", "start": 1914.404, "duration": 1.416}, {"text": "to try different passwords.", "start": 1915.82, "duration": 0.99}, {"text": "So that seems like\na reasonable plan.", "start": 1916.81, "duration": 1.541}, {"text": "So in combination\nwith salting, those", "start": 1918.351, "duration": 2.149}, {"text": "would be make it pretty\nexpensive to do password", "start": 1920.5, "duration": 2.38}, {"text": "guessing attacks.", "start": 1922.88, "duration": 1.107}, {"text": "Anything else?", "start": 1923.987, "duration": 0.583}, {"text": "So another thing is,\nyeah, challenge respond.", "start": 1927.035, "duration": 1.875}, {"text": "So you could actually hear\nin the initial protocol,", "start": 1928.91, "duration": 2.71}, {"text": "the Kerberos server\ndoesn't have any idea", "start": 1931.62, "duration": 2.17}, {"text": "if this was the\nright client or not.", "start": 1933.79, "duration": 1.93}, {"text": "But in fact, what\nyou could do is maybe", "start": 1935.72, "duration": 2.482}, {"text": "give a little bit of a\nproof that, well, you're", "start": 1938.202, "duration": 1.958}, {"text": "probably the right client.", "start": 1940.16, "duration": 1.85}, {"text": "So maybe you could encrypt\nthe current time stamp", "start": 1942.01, "duration": 2.97}, {"text": "with your hash\npassword or something", "start": 1944.98, "duration": 2.91}, {"text": "like this-- has them together.", "start": 1947.89, "duration": 1.565}, {"text": "And then the Kerberos\nserver could just", "start": 1949.455, "duration": 1.625}, {"text": "check if that's the right-- if\nthat matches, and if so, return", "start": 1951.08, "duration": 3.17}, {"text": "you back a ticket.", "start": 1954.25, "duration": 1.08}, {"text": "You probably don't want to\nnecessarily add more rounds", "start": 1955.33, "duration": 2.25}, {"text": "but this could work.", "start": 1957.58, "duration": 0.87}, {"text": "So just to precise about\nwhat I'm sort of suggesting.", "start": 1958.45, "duration": 2.31}, {"text": "OK, well, maybe you take\nthe current time stamp", "start": 1960.76, "duration": 3.7}, {"text": "and maybe you hash the current\ntime stamp and the KC together.", "start": 1964.46, "duration": 7.09}, {"text": "And maybe you include\nthe timestamp as well.", "start": 1971.55, "duration": 2.02}, {"text": "And then the server could\nsee, well, it has your KC.", "start": 1973.57, "duration": 2.387}, {"text": "It could hash the current\ntimestamp as well.", "start": 1975.957, "duration": 1.833}, {"text": "If it gets the same\nvalue, then yeah,", "start": 1977.79, "duration": 1.7}, {"text": "it's probably the right\nuser requesting it.", "start": 1979.49, "duration": 1.791}, {"text": "And I can send back the ticket.", "start": 1981.281, "duration": 1.589}, {"text": "If not, then it wasn't\nthe right password at all.", "start": 1982.87, "duration": 3.55}, {"text": "Question?", "start": 1986.42, "duration": 0.55}, {"text": "STUDENT: [INAUDIBLE] you just do\n[INAUDIBLE] if the servers see", "start": 1986.97, "duration": 6.071}, {"text": "too many requests [INAUDIBLE]", "start": 1993.041, "duration": 1.504}, {"text": "PROFESSOR: That's right.", "start": 1994.545, "duration": 1.0}, {"text": "So the problem is that\nwe could write limit.", "start": 1995.545, "duration": 2.025}, {"text": "But there's no\nreason for the hacker", "start": 1997.57, "duration": 1.5}, {"text": "to request this more than once.", "start": 1999.07, "duration": 2.05}, {"text": "That hacker requests a\nparticular user more than once", "start": 2001.12, "duration": 2.86}, {"text": "and then it gets\nthis encrypted blob.", "start": 2003.98, "duration": 2.26}, {"text": "And then it can try decrypting\nit offline as many times", "start": 2006.24, "duration": 2.74}, {"text": "as it wants with\ndifferent passwords", "start": 2008.98, "duration": 2.02}, {"text": "without having to re request it.", "start": 2011.0, "duration": 2.08}, {"text": "So I think the whole\npoint of including", "start": 2013.08, "duration": 1.87}, {"text": "some sort of a\nchallenge response thing", "start": 2014.95, "duration": 1.89}, {"text": "like this in the particle\nis so that the server will--", "start": 2016.84, "duration": 4.217}, {"text": "you'll have to actually\nask the server again", "start": 2021.057, "duration": 1.833}, {"text": "and again to try to log in\nwith different passwords.", "start": 2022.89, "duration": 3.919}, {"text": "And then you could rate\nlimit of the server", "start": 2026.809, "duration": 1.791}, {"text": "and get a much better defense.", "start": 2028.6, "duration": 2.1}, {"text": "Yeah.", "start": 2030.7, "duration": 0.94}, {"text": "STUDENT: [INAUDIBLE] Kerberos?", "start": 2031.64, "duration": 3.29}, {"text": "PROFESSOR: So I think you could\ncertainly replay this message", "start": 2034.93, "duration": 5.28}, {"text": "so if I sent this message\nnow, you could probably", "start": 2040.21, "duration": 3.12}, {"text": "look at that message\nand send it as well", "start": 2043.33, "duration": 2.09}, {"text": "and get a response back\nfrom the Kerberos server.", "start": 2045.42, "duration": 2.115}, {"text": "I guess if you're\nwatching the network,", "start": 2047.535, "duration": 1.624}, {"text": "you could observe this\nthing on the wire as well.", "start": 2049.159, "duration": 3.27}, {"text": "So I think this is sort of a bit\nof a stopgap measure-- improves", "start": 2052.429, "duration": 4.351}, {"text": "security a bit.", "start": 2056.78, "duration": 0.64}, {"text": "But certainly if you're\nwatching someone else's network,", "start": 2057.42, "duration": 3.582}, {"text": "then you're going to see this\npacket coming back regardless", "start": 2061.002, "duration": 2.458}, {"text": "of what happened in this step.", "start": 2063.46, "duration": 2.086}, {"text": "So coming back,\nyou'll see this guy", "start": 2065.546, "duration": 1.458}, {"text": "and you can then\ntry to attack it.", "start": 2067.004, "duration": 1.813}, {"text": "There's probably some\nmore elaborate schemes", "start": 2068.817, "duration": 1.833}, {"text": "you could design\nbut I didn't think", "start": 2070.65, "duration": 1.85}, {"text": "Kerberos 5 even\nimplements anything more", "start": 2072.5, "duration": 1.969}, {"text": "elaborate than roughly this\nplan, which seems good enough", "start": 2074.469, "duration": 3.121}, {"text": "to prevent arbitrary\npeople from trying", "start": 2077.59, "duration": 1.87}, {"text": "to break anyone's or brute\nforce anyone's password.", "start": 2079.46, "duration": 3.67}, {"text": "Make sense?", "start": 2083.13, "duration": 1.196}, {"text": "Yeah.", "start": 2084.326, "duration": 0.5}, {"text": "STUDENT: So presume\nthat you could", "start": 2084.826, "duration": 1.687}, {"text": "do authenticated [INAUDIBLE]\nor something here", "start": 2086.513, "duration": 4.015}, {"text": "to establish the shared key.", "start": 2090.528, "duration": 1.166}, {"text": "And then you could\nencrypt this thing", "start": 2091.694, "duration": 1.541}, {"text": "with KC and the shared key.", "start": 2093.235, "duration": 1.239}, {"text": "PROFESSOR: That's right, yeah.", "start": 2094.474, "duration": 0.826}, {"text": "So if you're really\ndoing this right,", "start": 2095.3, "duration": 1.541}, {"text": "there's all these nice\nparticles out there", "start": 2096.841, "duration": 2.789}, {"text": "that are basically called\npassword authenticated key", "start": 2099.63, "duration": 2.45}, {"text": "exchange particles, which is\nexactly what's going on here.", "start": 2102.08, "duration": 2.09}, {"text": "So if you're actually\nbuilding a system,", "start": 2104.17, "duration": 1.666}, {"text": "you should basically\nGoogle for SRP or PAKE.", "start": 2105.836, "duration": 2.964}, {"text": "And these protocols\nand related particles", "start": 2108.8, "duration": 3.88}, {"text": "will actually do this in\na much better way where", "start": 2112.68, "duration": 2.8}, {"text": "you can prove to both\nparties that you established", "start": 2115.48, "duration": 3.28}, {"text": "a new key and both parties\nare convinced that it's", "start": 2118.76, "duration": 2.09}, {"text": "the right other party\nand there's no way", "start": 2120.85, "duration": 2.76}, {"text": "to mount these offline\npassword guessing attacks", "start": 2123.61, "duration": 2.63}, {"text": "on the set of network packets\nthat you observe and so on.", "start": 2126.24, "duration": 3.442}, {"text": "So these are the\nsort of protocols.", "start": 2129.682, "duration": 1.458}, {"text": "And they're much more\nelaborate in terms", "start": 2131.14, "duration": 2.08}, {"text": "of crypto they rely on.", "start": 2133.22, "duration": 1.09}, {"text": "So it's hard to explain on a\nboard exactly why they work.", "start": 2134.31, "duration": 2.38}, {"text": "Yeah.", "start": 2136.69, "duration": 0.5}, {"text": "STUDENT: [INAUDIBLE]\npart of the reason", "start": 2137.19, "duration": 1.86}, {"text": "they did it this\nway is because they", "start": 2139.05, "duration": 1.888}, {"text": "wanted to maintain the ability\nof just sending the password.", "start": 2140.938, "duration": 3.776}, {"text": "And protocols just allow\nyou to send a single thing", "start": 2144.714, "duration": 3.651}, {"text": "as your authentication\n[INAUDIBLE].", "start": 2148.365, "duration": 2.475}, {"text": "PROFESSOR: Well,\nyeah, there's lots", "start": 2150.84, "duration": 1.98}, {"text": "of sort of weird requirements\nthat these guys had in mind.", "start": 2152.82, "duration": 4.13}, {"text": "I think they-- well,\ncertainly in practice,", "start": 2156.95, "duration": 4.59}, {"text": "these servers could accept\nboth Kerberos and non Kerberos", "start": 2161.54, "duration": 4.8}, {"text": "connections.", "start": 2166.34, "duration": 0.526}, {"text": "And for non Kerberos\nconnections,", "start": 2166.866, "duration": 1.374}, {"text": "you get-- like someone\nconnects to the mail server", "start": 2168.24, "duration": 1.79}, {"text": "but they're not using\nan Athena workstation.", "start": 2170.03, "duration": 1.49}, {"text": "They just want to\nsend their password.", "start": 2171.52, "duration": 1.66}, {"text": "And then the mail\nclient here, let's say,", "start": 2173.18, "duration": 1.709}, {"text": "is going to take\nyour password and is", "start": 2174.889, "duration": 1.541}, {"text": "going to get a ticket on\nyour behalf just to check it.", "start": 2176.43, "duration": 2.34}, {"text": "And then it's going to\nallow you to use it.", "start": 2178.77, "duration": 1.22}, {"text": "So you certainly want conversion\nfrom Kerberos from passwords", "start": 2179.99, "duration": 2.541}, {"text": "into checking against Kerberos.", "start": 2182.531, "duration": 2.588}, {"text": "I don't think this precludes\nit because certainly", "start": 2185.119, "duration": 2.041}, {"text": "Kerberos 5 deploys although\nthis hashes of timestamps,", "start": 2187.16, "duration": 3.673}, {"text": "et cetera.", "start": 2190.833, "duration": 0.499}, {"text": "STUDENT: Yeah but it's\nbecause they wouldn't", "start": 2191.332, "duration": 1.833}, {"text": "want multiple [INAUDIBLE].", "start": 2193.165, "duration": 1.863}, {"text": "PROFESSOR: Yeah, well,\nI think that probably", "start": 2195.028, "duration": 2.592}, {"text": "doesn't matter quite as much.", "start": 2197.62, "duration": 1.347}, {"text": "You could certainly have\nmultiple rounds in the back end", "start": 2198.967, "duration": 2.333}, {"text": "behind your library.", "start": 2201.3, "duration": 2.08}, {"text": "But there's some downsides\nto these particles--", "start": 2203.38, "duration": 3.29}, {"text": "probably not significant enough\nto stop you from using them.", "start": 2206.67, "duration": 3.51}, {"text": "Other questions?", "start": 2210.18, "duration": 2.86}, {"text": "All right, I guess\nthe other thing", "start": 2213.04, "duration": 1.84}, {"text": "I want to mention that\nyou should watch out", "start": 2214.88, "duration": 2.16}, {"text": "for in the paper is that these\nguys, in designing Kerberos 4,", "start": 2217.04, "duration": 4.04}, {"text": "they picked a single\nencryption scheme.", "start": 2221.08, "duration": 2.47}, {"text": "And at the time,\nthey basically picked", "start": 2223.55, "duration": 2.19}, {"text": "DES, which was a popular\nencryption scheme of the time.", "start": 2225.74, "duration": 3.52}, {"text": "It's a symmetric block cypher.", "start": 2229.26, "duration": 2.33}, {"text": "It goes pretty fast.", "start": 2231.59, "duration": 1.23}, {"text": "It was reasonably secure,\nnot necessarily the best,", "start": 2232.82, "duration": 3.27}, {"text": "but certainly good\nenough at the time.", "start": 2236.09, "duration": 2.302}, {"text": "And they just baked\nit into the protocol.", "start": 2238.392, "duration": 1.708}, {"text": "Everything in Kerberos has\nto use single DES or at least", "start": 2240.1, "duration": 2.78}, {"text": "everything in\nKerberos version 4.", "start": 2242.88, "duration": 2.01}, {"text": "And this was a bit problematic\nbecause 25 years later,", "start": 2244.89, "duration": 3.045}, {"text": "30 years later\nnow, it's actually", "start": 2247.935, "duration": 1.375}, {"text": "very cheap to brute\nforce DES encryption", "start": 2249.31, "duration": 3.51}, {"text": "because the keys are\nactually very small.", "start": 2252.82, "duration": 1.87}, {"text": "They're 56 bits.", "start": 2254.69, "duration": 1.88}, {"text": "So you could just search build\nsome custom hardware that", "start": 2256.57, "duration": 2.57}, {"text": "iterates over all the possible\n2 to the 56 combinations", "start": 2259.14, "duration": 2.95}, {"text": "and tries them all and figures\nout what someone's password is.", "start": 2262.09, "duration": 4.289}, {"text": "So this is something\nalso you want to avoid", "start": 2266.379, "duration": 1.791}, {"text": "in any protocol you design now.", "start": 2268.17, "duration": 1.54}, {"text": "Kerberos version 5\nactually supports", "start": 2269.71, "duration": 1.84}, {"text": "multiple different\nencryption schemes including", "start": 2271.55, "duration": 3.18}, {"text": "AES and other things as well.", "start": 2274.73, "duration": 2.155}, {"text": "So that seems like a\nmuch better way to do it.", "start": 2276.885, "duration": 2.465}, {"text": "On the other hand, MIT\nactually kept supporting DES up", "start": 2279.35, "duration": 2.97}, {"text": "until two years ago, which\nis a little unfortunate.", "start": 2282.32, "duration": 4.22}, {"text": "But now they don't.", "start": 2286.54, "duration": 1.02}, {"text": "So that's good.", "start": 2287.56, "duration": 0.97}, {"text": "Your principal is secure at\nleast from this kind of attack.", "start": 2288.53, "duration": 4.33}, {"text": "All right, so does\nthat make sense?", "start": 2292.86, "duration": 1.82}, {"text": "This is the initial\nway you'd get", "start": 2294.68, "duration": 1.67}, {"text": "any ticket at all in Kerberos.", "start": 2296.35, "duration": 1.86}, {"text": "And typically, you'd get this\nticket from this TGS service.", "start": 2298.21, "duration": 2.6}, {"text": "So now let's look at what's\ngoing on in this TGS service.", "start": 2300.81, "duration": 3.28}, {"text": "So here, the interaction\nwith the TGS service", "start": 2304.09, "duration": 3.61}, {"text": "is going to be a\nlittle different.", "start": 2307.7, "duration": 1.65}, {"text": "On one hand, you're\ngoing to-- as a client,", "start": 2309.35, "duration": 2.8}, {"text": "you're going to have\nto speak to it as", "start": 2312.15, "duration": 1.75}, {"text": "if you're speaking to any\nother Kerberos enabled service.", "start": 2313.9, "duration": 4.01}, {"text": "So we'll see how you\nauthenticate yourself", "start": 2317.91, "duration": 1.75}, {"text": "with a ticket to some machine.", "start": 2319.66, "duration": 2.054}, {"text": "But then the response\nyou're going to get back", "start": 2321.714, "duration": 1.916}, {"text": "is just a ticket for\nsome other principle", "start": 2323.63, "duration": 2.441}, {"text": "that you're going to want to\ncommunicate with like your file", "start": 2326.071, "duration": 2.499}, {"text": "server.", "start": 2328.57, "duration": 1.66}, {"text": "So the protocol level messages\nthat show up here kind of", "start": 2330.23, "duration": 3.98}, {"text": "look like this.", "start": 2334.21, "duration": 0.7}, {"text": "So here's your TGS service.", "start": 2334.91, "duration": 2.14}, {"text": "And here's a client.", "start": 2337.05, "duration": 2.18}, {"text": "The client already\ngot a ticket for TGS", "start": 2339.23, "duration": 3.52}, {"text": "using this protocol above.", "start": 2342.75, "duration": 1.34}, {"text": "So what the client is\nactually going to send over", "start": 2344.09, "duration": 2.49}, {"text": "is some combination\nof messages that", "start": 2346.58, "duration": 3.61}, {"text": "prove that this is\nthe right client", "start": 2350.19, "duration": 2.5}, {"text": "and they're issuing a request\nfor some particular principle", "start": 2352.69, "duration": 4.21}, {"text": "through TGS.", "start": 2356.9, "duration": 0.59}, {"text": "So what the client is going\nto send to TGS is this tuple.", "start": 2357.49, "duration": 2.924}, {"text": "So first, it's\ngoing to say, well,", "start": 2360.414, "duration": 1.416}, {"text": "here's the service that\nI want to talk to next.", "start": 2361.83, "duration": 2.17}, {"text": "So this might be your mail\nserver or your file server.", "start": 2364.0, "duration": 3.13}, {"text": "Then is going to\ninclude the ticket.", "start": 2367.13, "duration": 2.31}, {"text": "It already got 4TGS.", "start": 2369.44, "duration": 1.53}, {"text": "So this is going to be TC\nof TGS encrypted with KTGS.", "start": 2370.97, "duration": 7.13}, {"text": "So this is just this\nthing where S is TGS.", "start": 2378.1, "duration": 3.33}, {"text": "And then you're going to have\nto include this authenticator", "start": 2381.43, "duration": 2.46}, {"text": "blob.", "start": 2383.89, "duration": 1.0}, {"text": "This is this AC\nthing from up there.", "start": 2384.89, "duration": 3.265}, {"text": "And this thing is\ngoing to be encrypted", "start": 2388.155, "duration": 1.625}, {"text": "with a shared key between the\nclient and the TGS service.", "start": 2389.78, "duration": 5.112}, {"text": "So this is the message that\nyou're going to send to TGS.", "start": 2394.892, "duration": 3.468}, {"text": "It's going to look\nat this message,", "start": 2398.36, "duration": 2.039}, {"text": "do something with it that\nwe'll talk about in a second,", "start": 2400.399, "duration": 2.291}, {"text": "and respond back with a\nticket for this new service S.", "start": 2402.69, "duration": 5.08}, {"text": "So the response here looks\nalmost exactly like here.", "start": 2407.77, "duration": 2.93}, {"text": "In fact, it is exactly\nthe same thing.", "start": 2410.7, "duration": 1.79}, {"text": "It's going to be a\nticket between the client", "start": 2412.49, "duration": 2.12}, {"text": "and this new service\nS encrypted with KS", "start": 2414.61, "duration": 3.7}, {"text": "and the shared key between the\nclient and this new service", "start": 2418.31, "duration": 3.01}, {"text": "S encrypted-- well, now,\nhere's a little bit different.", "start": 2421.32, "duration": 3.72}, {"text": "Instead of encrypting with KC,\nwhich the client has probably", "start": 2425.04, "duration": 2.51}, {"text": "forgotten since\nthen, now we're going", "start": 2427.55, "duration": 1.73}, {"text": "to encrypt it with this\nshared key between the client", "start": 2429.28, "duration": 2.52}, {"text": "and the TGS service.", "start": 2431.8, "duration": 3.71}, {"text": "Makes sense?", "start": 2435.51, "duration": 2.52}, {"text": "All right, so in this-- how does\nthe server actually figure out", "start": 2438.03, "duration": 6.82}, {"text": "what the client wants to do?", "start": 2444.85, "duration": 1.74}, {"text": "Or, how does server\nauthenticate the client?", "start": 2446.59, "duration": 2.53}, {"text": "Well, in this case, it's\ngoing to-- TGS server actually", "start": 2449.12, "duration": 3.53}, {"text": "knows its own key, KTGS.", "start": 2452.65, "duration": 2.19}, {"text": "So it's going to first\ndecrypt this blob", "start": 2454.84, "duration": 2.55}, {"text": "and look inside the ticket and\nfigure out what's going on.", "start": 2457.39, "duration": 2.7}, {"text": "And there's all those\nnice fields in the ticket.", "start": 2460.09, "duration": 3.1}, {"text": "So let's just double check.", "start": 2463.19, "duration": 1.21}, {"text": "Why do we need all those\nfields in the ticket?", "start": 2464.4, "duration": 2.7}, {"text": "So is it important to have the\nserver name S in the ticket?", "start": 2467.1, "duration": 5.587}, {"text": "What would go wrong if you\ndidn't have S in there?", "start": 2472.687, "duration": 2.083}, {"text": "Anything?", "start": 2477.722, "duration": 1.96}, {"text": "Yeah.", "start": 2479.682, "duration": 0.5}, {"text": "STUDENT: They could\npotentially get", "start": 2480.182, "duration": 1.458}, {"text": "authorized to use any server.", "start": 2481.64, "duration": 2.97}, {"text": "PROFESSOR: Yeah, so it's\nin general a good idea", "start": 2484.61, "duration": 2.76}, {"text": "to be very explicit\nin network protocols", "start": 2487.37, "duration": 1.93}, {"text": "and to say exactly\nwhat a message means.", "start": 2489.3, "duration": 2.28}, {"text": "So in this case,\nif you omit an S,", "start": 2491.58, "duration": 2.33}, {"text": "you might be relying\non the fact that, well,", "start": 2493.91, "duration": 3.279}, {"text": "if it's the wrong S that you're\ntrying to use the ticket for,", "start": 2497.189, "duration": 2.541}, {"text": "then maybe you'll have a\ndifferent key over here", "start": 2499.73, "duration": 2.59}, {"text": "and then it wouldn't decrypt\nor something like this.", "start": 2502.32, "duration": 2.17}, {"text": "But it seems like a good idea\nto include it to make sure", "start": 2504.49, "duration": 2.333}, {"text": "that the server that\nreceives this tickets", "start": 2506.823, "duration": 1.807}, {"text": "decrypts and checks.", "start": 2508.63, "duration": 1.33}, {"text": "Is that a ticket for\nme or for someone else?", "start": 2509.96, "duration": 2.51}, {"text": "Yeah.", "start": 2512.47, "duration": 0.5}, {"text": "STUDENT: What does the\nclient get KTGS on?", "start": 2512.97, "duration": 2.552}, {"text": "PROFESSOR: Ah, good question.", "start": 2515.522, "duration": 1.208}, {"text": "The client has no\nidea what this is.", "start": 2516.73, "duration": 1.5}, {"text": "Because this is like\na super secret key.", "start": 2518.23, "duration": 1.83}, {"text": "If you knew this,\nyou'd probably be", "start": 2520.06, "duration": 1.71}, {"text": "able to break all of Kerberos.", "start": 2521.77, "duration": 1.71}, {"text": "So the client has no\nidea what KTGS is.", "start": 2523.48, "duration": 2.981}, {"text": "STUDENT: [INAUDIBLE]", "start": 2526.461, "duration": 0.833}, {"text": "PROFESSOR: Ah, yeah, yeah.", "start": 2527.294, "duration": 0.816}, {"text": "And then the where\nyou get it from", "start": 2528.11, "duration": 1.225}, {"text": "is actually-- it's the\nKerberos server itself", "start": 2529.335, "duration": 1.874}, {"text": "that generates this whole blob\nfor you where this is actually", "start": 2531.209, "duration": 3.621}, {"text": "TGS and this is KTGS over here.", "start": 2534.83, "duration": 3.95}, {"text": "So you don't construct\nthis yourself.", "start": 2538.78, "duration": 1.67}, {"text": "You just copy it over.", "start": 2540.45, "duration": 2.38}, {"text": "OK", "start": 2542.83, "duration": 0.83}, {"text": "So what is the client\nname there important for?", "start": 2543.66, "duration": 3.494}, {"text": "That should be\nfairly easy, right?", "start": 2547.154, "duration": 1.416}, {"text": "If you don't put the\nclient name in the ticket,", "start": 2548.57, "duration": 1.45}, {"text": "then the server\ngets this nice blob", "start": 2550.02, "duration": 1.81}, {"text": "but it has no idea who\nit's trying to talk to.", "start": 2551.83, "duration": 2.552}, {"text": "So it has no idea\nwhether it should", "start": 2554.382, "duration": 1.458}, {"text": "issue a ticket for my\nprincipal or for someone else's", "start": 2555.84, "duration": 3.05}, {"text": "principle, et cetera.", "start": 2558.89, "duration": 2.36}, {"text": "So what's the deal\nwith the other fields?", "start": 2561.25, "duration": 3.22}, {"text": "Why do these guys stick\nan address in the ticket?", "start": 2564.47, "duration": 2.155}, {"text": "This is the client's IP address.", "start": 2569.19, "duration": 2.285}, {"text": "Does it matter?", "start": 2571.475, "duration": 2.266}, {"text": "Yeah.", "start": 2573.741, "duration": 0.499}, {"text": "STUDENT: Can they\nuse that address", "start": 2574.24, "duration": 2.392}, {"text": "with the ticket to verify\nagainst the [INAUDIBLE]?", "start": 2576.632, "duration": 3.267}, {"text": "PROFESSOR: Sort of.", "start": 2579.899, "duration": 0.791}, {"text": "Well, so I think\nthe general plan", "start": 2580.69, "duration": 1.632}, {"text": "for why there's\naddresses appearing", "start": 2582.322, "duration": 1.458}, {"text": "everywhere here,\nthese IP addresses,", "start": 2583.78, "duration": 1.51}, {"text": "is that these guys at the\ntime were still slightly", "start": 2585.29, "duration": 2.93}, {"text": "confused and--\nwell, in some ways--", "start": 2588.22, "duration": 3.182}, {"text": "they were still\nthinking, OK, well,", "start": 2591.402, "duration": 1.458}, {"text": "we're going to rely\non IP addresses", "start": 2592.86, "duration": 1.458}, {"text": "for a little bit of security.", "start": 2594.318, "duration": 1.482}, {"text": "So they wanted to make sure\nthat if the client logged in", "start": 2595.8, "duration": 3.55}, {"text": "from some IP address, then\neverything else going on", "start": 2599.35, "duration": 2.48}, {"text": "with that ticket happen\nfrom that same IP address.", "start": 2601.83, "duration": 2.47}, {"text": "So if you logged in\nfrom some IP address", "start": 2604.3, "duration": 2.77}, {"text": "on 18.26.4.9 or something,\nthen every connection", "start": 2607.07, "duration": 3.996}, {"text": "you make to a file server\nor to a mail server", "start": 2611.066, "duration": 1.874}, {"text": "has to be from the\nsame IP address.", "start": 2612.94, "duration": 1.34}, {"text": "Otherwise, the server should\nreject your connection", "start": 2614.28, "duration": 2.125}, {"text": "as being stolen by-- or\nsomeone stole your ticket.", "start": 2616.405, "duration": 3.165}, {"text": "So we're thinking,\nOK, well, maybe we'll", "start": 2619.57, "duration": 1.93}, {"text": "defend against ticket\ntheft this way.", "start": 2621.5, "duration": 1.85}, {"text": "If you still a ticket,\nwell, but you're", "start": 2623.35, "duration": 1.66}, {"text": "not using the same IP address.", "start": 2625.01, "duration": 1.25}, {"text": "So it won't work.", "start": 2626.26, "duration": 1.425}, {"text": "It's probably a little bit\nmisguided at this point", "start": 2627.685, "duration": 2.145}, {"text": "but-- that sort of gets in the\nway And Kerberos 5 still has it", "start": 2629.83, "duration": 3.15}, {"text": "but it's largely optional.", "start": 2632.98, "duration": 1.37}, {"text": "Really, you should just rely on\ncryptography instead of any IP", "start": 2634.35, "duration": 4.06}, {"text": "address security.", "start": 2638.41, "duration": 2.02}, {"text": "So what's the point of the\ntime stamp and lifetime things", "start": 2640.43, "duration": 2.46}, {"text": "in the ticket up there?", "start": 2642.89, "duration": 1.87}, {"text": "One are those guys good for?", "start": 2644.76, "duration": 1.685}, {"text": "Are they useful?", "start": 2646.445, "duration": 2.15}, {"text": "Yeah.", "start": 2648.595, "duration": 0.5}, {"text": "STUDENT: Preventing\nreplay attacks.", "start": 2649.095, "duration": 2.175}, {"text": "PROFESSOR: Well,\nso the syndicator", "start": 2651.27, "duration": 1.417}, {"text": "is the thing that's\ngoing to help us prevent", "start": 2652.687, "duration": 1.833}, {"text": "replay attacks in a second.", "start": 2654.52, "duration": 1.56}, {"text": "Because that thing gets\ngenerated every time", "start": 2656.08, "duration": 2.39}, {"text": "you do a new request.", "start": 2658.47, "duration": 1.9}, {"text": "On the other hand, the\nticket just stays the same.", "start": 2660.37, "duration": 2.12}, {"text": "So it's certainly not\npreventing replay attacks there.", "start": 2662.49, "duration": 2.249}, {"text": "Yeah.", "start": 2664.739, "duration": 0.565}, {"text": "STUDENT: It prevents somebody\nfrom stealing your ticket then", "start": 2665.304, "duration": 2.5}, {"text": "using it [INAUDIBLE]", "start": 2667.804, "duration": 0.834}, {"text": "PROFESSOR: Oh, sorry, yes.", "start": 2668.638, "duration": 1.082}, {"text": "This just bounds the time\nfor which a ticket is valid,", "start": 2669.72, "duration": 2.33}, {"text": "meaning that the damage\nfrom disclosing it", "start": 2672.05, "duration": 2.58}, {"text": "is hopefully reduced.", "start": 2674.63, "duration": 2.48}, {"text": "So the plan is the timestamp\nis roughly the time when", "start": 2677.11, "duration": 2.79}, {"text": "you initially got the ticket.", "start": 2679.9, "duration": 1.47}, {"text": "And a lifetime in\nthe ticket represents", "start": 2681.37, "duration": 2.7}, {"text": "how many hours,\nlet's say, it's valid", "start": 2684.07, "duration": 2.96}, {"text": "from that initial timestamp.", "start": 2687.03, "duration": 1.87}, {"text": "So if you try to use it\ntoo early or too late,", "start": 2688.9, "duration": 2.15}, {"text": "then every server should\nreject such a ticket", "start": 2691.05, "duration": 3.05}, {"text": "in the Kerberos protocol.", "start": 2694.1, "duration": 1.94}, {"text": "So this kind of means\nthat every server", "start": 2696.04, "duration": 2.14}, {"text": "has to have a loosely\nsynchronized, clock which", "start": 2698.18, "duration": 4.679}, {"text": "is a bit of a-- well,\nmaybe you've run into this.", "start": 2702.859, "duration": 2.041}, {"text": "Like, your laptop clock is off\nand you can't log into Kerberos", "start": 2704.9, "duration": 2.583}, {"text": "anymore.", "start": 2707.483, "duration": 0.638}, {"text": "Question?", "start": 2708.121, "duration": 0.499}, {"text": "Yeah.", "start": 2708.62, "duration": 0.57}, {"text": "STUDENT: You said before\nthat the client discards KC", "start": 2709.19, "duration": 2.79}, {"text": "but they're still\nkeeping KCS [INAUDIBLE]", "start": 2711.98, "duration": 2.8}, {"text": "the TGS. [INAUDIBLE]", "start": 2714.78, "duration": 1.525}, {"text": "PROFESSOR: That's right, yeah.", "start": 2716.305, "duration": 1.25}, {"text": "So the client discards\nKC after logging in.", "start": 2717.555, "duration": 2.755}, {"text": "But it still keeps KCS.", "start": 2720.31, "duration": 1.29}, {"text": "You're exactly right.", "start": 2721.6, "duration": 1.397}, {"text": "STUDENT: So if someone\nsteals the KCS,", "start": 2722.997, "duration": 1.583}, {"text": "then they have access\nto [INAUDIBLE].", "start": 2724.58, "duration": 2.907}, {"text": "PROFESSOR: Yeah, OK.", "start": 2727.487, "duration": 0.833}, {"text": "So how bad is that?", "start": 2728.32, "duration": 0.791}, {"text": "Like, why is it better\nto disclose this KCS", "start": 2729.111, "duration": 3.781}, {"text": "fof-- actually, well,\nthis is TGS, right?", "start": 2732.892, "duration": 1.708}, {"text": "Why is it better to\ndisclose KCTGS than KC?", "start": 2734.6, "duration": 2.635}, {"text": "Yeah.", "start": 2739.98, "duration": 0.938}, {"text": "STUDENT: Someone [INAUDIBLE]\nsomewhere [INAUDIBLE].", "start": 2740.918, "duration": 2.287}, {"text": "PROFESSOR: It's\nthe kind of thing", "start": 2743.205, "duration": 1.375}, {"text": "that they're both keys, though.", "start": 2744.58, "duration": 0.81}, {"text": "So neither of them are\nreally hashed, yeah.", "start": 2745.39, "duration": 1.791}, {"text": "STUDENT: You would take\nKCS and you'd just steal", "start": 2747.181, "duration": 2.352}, {"text": "that session between those two.", "start": 2749.533, "duration": 1.705}, {"text": "But if you steal KC, you\ncan impersonate the client.", "start": 2751.238, "duration": 2.502}, {"text": "PROFESSOR: That's right.", "start": 2753.74, "duration": 1.0}, {"text": "Yeah.", "start": 2754.74, "duration": 0.5}, {"text": "So I guess one\nway to answer this", "start": 2755.24, "duration": 1.49}, {"text": "is that KCTGS, this is actually\na new key generated every time", "start": 2756.73, "duration": 4.09}, {"text": "you log in initially.", "start": 2760.82, "duration": 2.0}, {"text": "And this thing is only good\nbecause you have this ticket", "start": 2762.82, "duration": 3.73}, {"text": "that goes along with it.", "start": 2766.55, "duration": 2.07}, {"text": "If you lose this ticket or if\nthis ticket is no longer valid,", "start": 2768.62, "duration": 2.93}, {"text": "then yeah, you have these\n56 bits in this key.", "start": 2771.55, "duration": 2.95}, {"text": "But no one is going to assume\nanything from those bits.", "start": 2774.5, "duration": 4.38}, {"text": "The only reason these\nbits are interesting", "start": 2778.88, "duration": 1.88}, {"text": "is because this ticket talks\nabout this KCS being valid", "start": 2780.76, "duration": 3.44}, {"text": "right now.", "start": 2784.2, "duration": 0.96}, {"text": "And there's a bound on it.", "start": 2785.16, "duration": 1.726}, {"text": "STUDENT: Yeah, so if\nthey stole both of those", "start": 2786.886, "duration": 1.904}, {"text": "[INAUDIBLE] be bounded.", "start": 2788.79, "duration": 1.789}, {"text": "PROFESSOR: Yeah, if someone\nsteals both of these blogs,", "start": 2790.579, "duration": 2.291}, {"text": "than they can impersonate you\nor, like, log into your file", "start": 2792.87, "duration": 3.17}, {"text": "server, mail server for the\nlifetime of that ticket, which", "start": 2796.04, "duration": 3.41}, {"text": "is a couple of\nhours or 10 hours.", "start": 2799.45, "duration": 2.54}, {"text": "Stealing this, there's no time\nbound on that until you change", "start": 2801.99, "duration": 2.77}, {"text": "your password and maybe worse.", "start": 2804.76, "duration": 2.595}, {"text": "Make sense?", "start": 2807.355, "duration": 2.365}, {"text": "All right, so it\nseems like, yeah,", "start": 2809.72, "duration": 3.33}, {"text": "all those fields are\nkind of important,", "start": 2813.05, "duration": 1.79}, {"text": "IP address maybe less so.", "start": 2814.84, "duration": 2.97}, {"text": "And now in response, right, we\ncan get this ticket finally.", "start": 2817.81, "duration": 4.41}, {"text": "And because we know KCTGS,\nwe can decrypt the response", "start": 2822.22, "duration": 3.73}, {"text": "from this TGS server.", "start": 2825.95, "duration": 1.17}, {"text": "And now we have a\nticket for any server", "start": 2827.12, "duration": 2.67}, {"text": "we want-- a file server,\nmail server, whatever", "start": 2829.79, "duration": 2.56}, {"text": "it is that we finally\ncare about connecting to.", "start": 2832.35, "duration": 3.49}, {"text": "Make sense?", "start": 2835.84, "duration": 2.63}, {"text": "All right, so let's look at\nhow you might sort of finally", "start": 2838.47, "duration": 4.58}, {"text": "use this in some\napplication level protocol.", "start": 2843.05, "duration": 3.46}, {"text": "So suppose that maybe I'm\ntalking to a mail server", "start": 2846.51, "duration": 3.58}, {"text": "to fetch my messages.", "start": 2850.09, "duration": 1.52}, {"text": "So presumably, what my client\nworkstation is going to do", "start": 2851.61, "duration": 3.24}, {"text": "is going to send a tickets\nrequesting for, I don't know,", "start": 2854.85, "duration": 2.395}, {"text": "mail.po12.", "start": 2857.245, "duration": 2.525}, {"text": "And it'll get back a ticket\nfor the principal mail.po12", "start": 2859.77, "duration": 3.61}, {"text": "or something like this.", "start": 2863.38, "duration": 1.47}, {"text": "And then inside of this ticket\nor inside of this response,", "start": 2864.85, "duration": 4.49}, {"text": "now I have a shared\nkey between me", "start": 2869.34, "duration": 2.59}, {"text": "and the mail server-- S is\nthe male server over here--", "start": 2871.93, "duration": 3.15}, {"text": "and this ticket a blob\nthat I can to the mail", "start": 2875.08, "duration": 2.64}, {"text": "server to convince it\nthat I'm the right guy", "start": 2877.72, "duration": 2.15}, {"text": "or anyone with this key\nis the right principle.", "start": 2879.87, "duration": 4.809}, {"text": "And then we can actually have\nan encrypted conversation", "start": 2884.679, "duration": 2.291}, {"text": "with the mail server\nusing this new key KCS.", "start": 2886.97, "duration": 5.25}, {"text": "So what I might do as\na client is-- well,", "start": 2892.22, "duration": 4.77}, {"text": "initially, I send some\nmessage to the mail server", "start": 2896.99, "duration": 3.21}, {"text": "that includes this\nticket TC mail encrypted", "start": 2900.2, "duration": 5.78}, {"text": "with the key of the mail server.", "start": 2905.98, "duration": 2.9}, {"text": "And then I can actually\nsend some message along", "start": 2908.88, "duration": 2.63}, {"text": "with this request that maybe\nsays something like, well,", "start": 2911.51, "duration": 4.67}, {"text": "delete some message-- delete 5.", "start": 2916.18, "duration": 4.46}, {"text": "And I can encrypt\nthis with KC mail.", "start": 2920.64, "duration": 5.72}, {"text": "Does that make sense?", "start": 2926.36, "duration": 2.689}, {"text": "OK, so what happens in this\nprotocol on the mail server", "start": 2929.049, "duration": 2.291}, {"text": "side?", "start": 2931.34, "duration": 0.72}, {"text": "The mail server is going to\nuse its secret key K mail", "start": 2932.06, "duration": 3.48}, {"text": "to decrypt this ticket first.", "start": 2935.54, "duration": 1.934}, {"text": "And then it looks\ninside there and finds", "start": 2937.474, "duration": 1.666}, {"text": "two important things-- the\nprincipal name C of who", "start": 2939.14, "duration": 3.66}, {"text": "is it that's talking to it in\nthe first place and the key KCS", "start": 2942.8, "duration": 4.214}, {"text": "that it should be\nusing to decrypt", "start": 2947.014, "duration": 1.416}, {"text": "all the subsequent traffic\nand authenticate it ideally", "start": 2948.43, "duration": 2.725}, {"text": "in Kerberos 5, at least.", "start": 2951.155, "duration": 1.454}, {"text": "And then you can decrypt this\nmessage and say oh, well, yeah.", "start": 2952.609, "duration": 2.541}, {"text": "User C is trying to\ndelete message five.", "start": 2955.15, "duration": 2.22}, {"text": "So I'll run this command.", "start": 2957.37, "duration": 2.115}, {"text": "Make sense?", "start": 2959.485, "duration": 0.5}, {"text": "You had a question?", "start": 2959.985, "duration": 1.331}, {"text": "STUDENT: Yeah, so\nKerberos initially", "start": 2961.316, "duration": 3.184}, {"text": "sends the TGS ticket in KCTGS.", "start": 2964.5, "duration": 5.87}, {"text": "Where's [INAUDIBLE]?", "start": 2970.37, "duration": 2.25}, {"text": "PROFESSOR: So AC, those\nauthenticators are actually", "start": 2972.62, "duration": 2.88}, {"text": "generated by the client.", "start": 2975.5, "duration": 1.61}, {"text": "Note that the client\nonly needs KCS", "start": 2977.11, "duration": 3.17}, {"text": "to generate an authenticator.", "start": 2980.28, "duration": 2.11}, {"text": "So the client can make\nthese up any time it wants.", "start": 2982.39, "duration": 2.95}, {"text": "So the general plan for\nindicators or the reason", "start": 2985.34, "duration": 2.91}, {"text": "to use authenticators is roughly\nto prevent replay attack.", "start": 2988.25, "duration": 3.72}, {"text": "So the client, or at least in\nthe way that the Kerberos 4", "start": 2991.97, "duration": 3.5}, {"text": "developers were\nintending it, the client,", "start": 2995.47, "duration": 2.37}, {"text": "every time it sends\na new request ,", "start": 2997.84, "duration": 2.08}, {"text": "it would generate a new\nauthenticator to say OK, well,", "start": 2999.92, "duration": 3.06}, {"text": "this is a new request.", "start": 3002.98, "duration": 1.019}, {"text": "I'm issuing it now.", "start": 3003.999, "duration": 0.791}, {"text": "It's different from all\nthe previous requests.", "start": 3004.79, "duration": 1.916}, {"text": "Go do it.", "start": 3006.706, "duration": 1.034}, {"text": "And the general plan\nwas that the server", "start": 3007.74, "duration": 3.37}, {"text": "would keep a cache of\nthese authenticators that", "start": 3011.11, "duration": 4.44}, {"text": "were sent within the\nlast five minutes or so.", "start": 3015.55, "duration": 3.28}, {"text": "So if it ever sees a\nduplicate authenticator,", "start": 3018.83, "duration": 1.88}, {"text": "it says oh, that's\na replay request.", "start": 3020.71, "duration": 1.6}, {"text": "I'm going to reject it.", "start": 3022.31, "duration": 1.82}, {"text": "And if it sees an\nauthenticator that's", "start": 3024.13, "duration": 2.22}, {"text": "outside of a five\nminute boundary,", "start": 3026.35, "duration": 2.03}, {"text": "it doesn't have it in the cache.", "start": 3028.38, "duration": 1.59}, {"text": "But it will look at the time\nstamp in the authenticator", "start": 3029.97, "duration": 3.25}, {"text": "and say, well, this is a\nvery old authenticator.", "start": 3033.22, "duration": 2.0}, {"text": "I'll just reject your\nrequest because it's too old.", "start": 3035.22, "duration": 2.48}, {"text": "Send it again if\nyou really care.", "start": 3037.7, "duration": 2.0}, {"text": "So that's the general\nplan for indicators.", "start": 3039.7, "duration": 2.47}, {"text": "As with many things\nin Kerberos, they", "start": 3042.17, "duration": 2.24}, {"text": "were slightly broken--\nin Kerberos 4, at least.", "start": 3044.41, "duration": 2.75}, {"text": "Because this\nauthenticator actually", "start": 3047.16, "duration": 1.73}, {"text": "says nothing about the\nmessage you're sending, right?", "start": 3048.89, "duration": 2.208}, {"text": "It's some blob.", "start": 3051.098, "duration": 0.924}, {"text": "So the way you would\nuse it, for example,", "start": 3052.022, "duration": 1.708}, {"text": "in this mail server protocol\nis-- or at least in Kerberos", "start": 3053.73, "duration": 3.88}, {"text": "4-- well, you would\ngenerate some authenticator", "start": 3057.61, "duration": 2.44}, {"text": "and you would be to\ntake the authenticator", "start": 3060.05, "duration": 2.33}, {"text": "and you would encrypt\nit with also KC mail.", "start": 3062.38, "duration": 4.192}, {"text": "And the mail server would\nkeep track of, well, yeah,", "start": 3066.572, "duration": 2.618}, {"text": "you've sent this [INAUDIBLE]\nindicator before.", "start": 3069.19, "duration": 1.916}, {"text": "No, you haven't.", "start": 3071.106, "duration": 0.901}, {"text": "But there's nothing here that\nconnects the authenticator", "start": 3072.007, "duration": 2.333}, {"text": "to the message you are sending.", "start": 3074.34, "duration": 1.43}, {"text": "So for the first\nmessage, this was great.", "start": 3075.77, "duration": 2.142}, {"text": "But when you send\na second message,", "start": 3077.912, "duration": 1.458}, {"text": "you're going to generate\na second authenticator.", "start": 3079.37, "duration": 2.07}, {"text": "And someone on the\nnetwork can say, oh, yeah,", "start": 3081.44, "duration": 1.54}, {"text": "I got your new authenticator.", "start": 3082.98, "duration": 1.33}, {"text": "I can take your\nnew authenticator", "start": 3084.31, "duration": 1.43}, {"text": "and splice in the\nold delete message.", "start": 3085.74, "duration": 2.39}, {"text": "So I'll force you to delete\nthe fifth message twice,", "start": 3088.13, "duration": 3.05}, {"text": "even though the\nsecond command meant", "start": 3091.18, "duration": 1.77}, {"text": "to send some other operation.", "start": 3092.95, "duration": 3.01}, {"text": "So Kerberos 5 gets this\nright where you actually", "start": 3095.96, "duration": 4.859}, {"text": "stick something in the\nauthenticator that relates", "start": 3100.819, "duration": 2.041}, {"text": "to the command you're issuing.", "start": 3102.86, "duration": 2.24}, {"text": "You could do this, of course,\nbut sort of took a while", "start": 3105.1, "duration": 2.624}, {"text": "for people to realize\nthat, well, here's", "start": 3107.724, "duration": 1.666}, {"text": "how you should design\na protocol correctly.", "start": 3109.39, "duration": 3.41}, {"text": "Make sense?", "start": 3112.8, "duration": 0.74}, {"text": "Yeah, other question.", "start": 3113.54, "duration": 1.174}, {"text": "STUDENT: [INAUDIBLE]", "start": 3114.714, "duration": 0.833}, {"text": "PROFESSOR: Ah, so the\nclient gets case email", "start": 3118.158, "duration": 2.892}, {"text": "from this response.", "start": 3121.05, "duration": 1.29}, {"text": "So the client, when it wants\nto talk to the mail server,", "start": 3122.34, "duration": 2.84}, {"text": "it's going to ask the TGS for\na ticket for the mail server.", "start": 3125.18, "duration": 3.06}, {"text": "And here, S is basically this\nmail server's principal name.", "start": 3128.24, "duration": 4.26}, {"text": "So when it comes back,\nthis says S equals mail", "start": 3132.5, "duration": 3.87}, {"text": "and this server key\nS is equal to mail.", "start": 3136.37, "duration": 3.29}, {"text": "And this KCS is\nactually KC mail.", "start": 3139.66, "duration": 2.81}, {"text": "So this is how the client\nlearns of the shared key", "start": 3145.92, "duration": 2.91}, {"text": "that it has between it and the\nfiles and the mail server here.", "start": 3148.83, "duration": 4.04}, {"text": "And there's a copy of\nit inside the ticket.", "start": 3152.87, "duration": 1.98}, {"text": "Question back there?", "start": 3154.85, "duration": 0.84}, {"text": "STUDENT: How does the\nmail server get KC mail?", "start": 3155.69, "duration": 2.369}, {"text": "PROFESSOR: Ah, yes.", "start": 3158.059, "duration": 0.791}, {"text": "So how does the mail\nserver get this shared key?", "start": 3158.85, "duration": 2.13}, {"text": "Like, the mail server\nmight have never heard", "start": 3160.98, "duration": 2.03}, {"text": "of your connection before,\nnever heard of you.", "start": 3163.01, "duration": 1.916}, {"text": "Where does KC mail come from\non the mail server side?", "start": 3164.926, "duration": 2.834}, {"text": "Yeah.", "start": 3167.76, "duration": 1.129}, {"text": "STUDENT: Isn't it\npart of the ticket?", "start": 3168.889, "duration": 1.541}, {"text": "PROFESSOR: Yeah, yeah, so\nthis is the cool thing.", "start": 3170.43, "duration": 1.01}, {"text": "You send this ticket over to the\nmail server and the mail server", "start": 3171.44, "duration": 2.666}, {"text": "knows its own secret key K mail.", "start": 3174.106, "duration": 2.074}, {"text": "And it uses that to decrypt the\nticket TC mail and the shared", "start": 3176.18, "duration": 4.8}, {"text": "key is in there along\nwith the name of whoever", "start": 3180.98, "duration": 2.45}, {"text": "it is that you're\nsharing this key with.", "start": 3183.43, "duration": 2.226}, {"text": "That's how it finds out,\noh, I'm talking to the guy", "start": 3185.656, "duration": 2.124}, {"text": "and that's the shared\nkey we should use.", "start": 3187.78, "duration": 3.23}, {"text": "Makes sense?", "start": 3191.01, "duration": 1.92}, {"text": "All right, so that's\nthe sort of basic plan", "start": 3192.93, "duration": 3.04}, {"text": "for how you use this protocol\nin some actual application.", "start": 3195.97, "duration": 4.98}, {"text": "There's-- well, there's a\nbunch of problems with this.", "start": 3200.95, "duration": 6.54}, {"text": "So Kerberos is-- it's\na nice paper to read", "start": 3207.49, "duration": 2.86}, {"text": "but then there's all these\nproblems these guys didn't", "start": 3210.35, "duration": 2.22}, {"text": "know about 30 years ago.", "start": 3212.57, "duration": 1.05}, {"text": "So it's sort of inevitable\nthat there's problems", "start": 3213.62, "duration": 3.19}, {"text": "you have to go through.", "start": 3216.81, "duration": 1.43}, {"text": "So one interesting\nproblem in the way", "start": 3218.24, "duration": 2.94}, {"text": "Kerberos 4 encrypted and\nauthenticated messages", "start": 3221.18, "duration": 4.64}, {"text": "for applications is that\nthey use the same key", "start": 3225.82, "duration": 3.32}, {"text": "for encrypting messages from\nthe client to the server", "start": 3229.14, "duration": 3.82}, {"text": "as well as messages from the\nserver back to the client.", "start": 3232.96, "duration": 3.62}, {"text": "So suppose that the client\nissues, I don't know,", "start": 3236.58, "duration": 4.72}, {"text": "a request to fetch a\nparticular message.", "start": 3241.3, "duration": 2.81}, {"text": "So then I say, you know,\nfetch the message 7.", "start": 3244.11, "duration": 4.61}, {"text": "And I encrypt this\nthing with KC mail.", "start": 3248.72, "duration": 5.0}, {"text": "That seems all great.", "start": 3253.72, "duration": 1.45}, {"text": "The mail server has\nthe shared key that's", "start": 3255.17, "duration": 2.42}, {"text": "going to decrypt this message.", "start": 3257.59, "duration": 1.45}, {"text": "And it's going to send me back\nthe body of this email message", "start": 3259.04, "duration": 4.65}, {"text": "also encrypted with KC mail.", "start": 3263.69, "duration": 3.22}, {"text": "Does anyone see a\nproblem with this?", "start": 3266.91, "duration": 2.59}, {"text": "Why is this is potentially\na bad thing to do?", "start": 3269.5, "duration": 3.68}, {"text": "Anyone else?", "start": 3273.18, "duration": 1.69}, {"text": "Sure.", "start": 3274.87, "duration": 1.551}, {"text": "STUDENT: So there's\na chapter [INAUDIBLE]", "start": 3276.421, "duration": 3.109}, {"text": "they can make [INAUDIBLE] look\nlike some other things they", "start": 3279.53, "duration": 2.574}, {"text": "want [INAUDIBLE]", "start": 3282.104, "duration": 0.702}, {"text": "PROFESSOR: Yes, so\nthose are actually", "start": 3282.806, "duration": 0.944}, {"text": "worrisome because I could send\nyou any email message I want.", "start": 3283.75, "duration": 2.694}, {"text": "So suppose I really want\nto delete some message that", "start": 3286.444, "duration": 2.166}, {"text": "is sitting here in\nyour inbox and I", "start": 3288.61, "duration": 1.458}, {"text": "don't want you to read it.", "start": 3290.068, "duration": 1.182}, {"text": "I know it's maybe\nmessage, I don't know, 23.", "start": 3291.25, "duration": 2.39}, {"text": "So I'm going to send you an\nemail that says, delete 23.", "start": 3293.64, "duration": 2.292}, {"text": "You're going to read it.", "start": 3295.932, "duration": 0.999}, {"text": "You're going to fetch\nit and a response", "start": 3296.931, "duration": 1.869}, {"text": "is going to come from\nthe mail server saying,", "start": 3298.8, "duration": 1.875}, {"text": "delete 23 encrypted\nwith this key.", "start": 3300.675, "duration": 2.411}, {"text": "And so far, it's not being\nsent to the mail server.", "start": 3303.086, "duration": 2.124}, {"text": "But if I look at the\nnetwork at the right time", "start": 3305.21, "duration": 1.916}, {"text": "and capture this packet,\nI can send the packet back", "start": 3307.126, "duration": 2.414}, {"text": "to the mail server.", "start": 3309.54, "duration": 1.15}, {"text": "It would look like a message\nsaying delete 23 encrypted", "start": 3310.69, "duration": 3.21}, {"text": "with the right key.", "start": 3313.9, "duration": 1.167}, {"text": "And the mail server\nwill say, oh yeah, sure.", "start": 3315.067, "duration": 1.833}, {"text": "You're trying to\ndelete this message.", "start": 3316.9, "duration": 1.541}, {"text": "I'll do it.", "start": 3318.441, "duration": 0.749}, {"text": "So this is a bit of\na problem because we", "start": 3319.19, "duration": 2.78}, {"text": "are allowing an adversary\nto confuse the mail", "start": 3321.97, "duration": 3.1}, {"text": "server into whether our\nmessage was generated by it", "start": 3325.07, "duration": 2.79}, {"text": "or was sent to it\nin the first place.", "start": 3327.86, "duration": 2.732}, {"text": "So this is quite troublesome.", "start": 3330.592, "duration": 1.429}, {"text": "So these are what's\ntypically called", "start": 3332.021, "duration": 1.499}, {"text": "in cryptography and\nprotocol literature", "start": 3333.52, "duration": 1.624}, {"text": "as reflection attacks.", "start": 3335.144, "duration": 2.533}, {"text": "So you have any suggestions for\nhow we can avoid this problem?", "start": 3337.677, "duration": 2.583}, {"text": "Yeah.", "start": 3340.26, "duration": 0.4}, {"text": "STUDENT: Can't you just include\na header saying its origins?", "start": 3340.66, "duration": 2.325}, {"text": "PROFESSOR: Yeah,\nso typically, you", "start": 3342.985, "duration": 1.455}, {"text": "want to have some very\nunambiguous way to state what's", "start": 3344.44, "duration": 2.51}, {"text": "going on.", "start": 3346.95, "duration": 0.95}, {"text": "One way is to have a header\nin every message that says,", "start": 3347.9, "duration": 2.464}, {"text": "this is going from the client\nto the server or from server", "start": 3350.364, "duration": 2.416}, {"text": "to the client.", "start": 3352.78, "duration": 0.94}, {"text": "And even better plan\nin practice turns out", "start": 3353.72, "duration": 2.14}, {"text": "to be just use\ntwo separate keys.", "start": 3355.86, "duration": 1.66}, {"text": "Because you might want to\nhave a long stream of data", "start": 3357.52, "duration": 2.65}, {"text": "where you don't really have\nspace for this header bit.", "start": 3360.17, "duration": 2.69}, {"text": "So instead, what Kerberos 5\ndoes is every time you establish", "start": 3362.86, "duration": 3.52}, {"text": "a connection with some service ,\nyou actually negotiate two keys", "start": 3366.38, "duration": 2.85}, {"text": "instead of just one key.", "start": 3369.23, "duration": 1.46}, {"text": "And the first key is going to\nbe used for encrypting stuff", "start": 3370.69, "duration": 2.84}, {"text": "from client to server and other\nfrom server back to the client.", "start": 3373.53, "duration": 3.25}, {"text": "So that seems like a much\nbetter way to do it in practice.", "start": 3376.78, "duration": 4.23}, {"text": "Make sense?", "start": 3381.01, "duration": 3.21}, {"text": "All right, so I guess\nlet's now talk a little bit", "start": 3384.22, "duration": 6.53}, {"text": "about what happens with KDC.", "start": 3390.75, "duration": 3.03}, {"text": "So the Kerberos server is\npretty important to the system.", "start": 3393.78, "duration": 5.09}, {"text": "But what happens if\nthis KDC goes down?", "start": 3398.87, "duration": 3.13}, {"text": "So how bad is it to our system.", "start": 3402.0, "duration": 2.36}, {"text": "Like, in Athena,\nsuppose if KDC crashes,", "start": 3404.36, "duration": 3.37}, {"text": "does this affect your life?", "start": 3407.73, "duration": 1.6}, {"text": "Well, if you use Athena.", "start": 3409.33, "duration": 1.184}, {"text": "STUDENT: Is that why\nyou can't log in?", "start": 3410.514, "duration": 1.583}, {"text": "PROFESSOR: Yeah, so\nyou can't log in.", "start": 3412.097, "duration": 1.725}, {"text": "I guess the other thing is\nyou also can't get tickets", "start": 3413.822, "duration": 2.208}, {"text": "to new things as well.", "start": 3416.03, "duration": 1.98}, {"text": "But kind of the cool thing\nis that the KDC is largely", "start": 3418.01, "duration": 2.77}, {"text": "off the critical path\nfor existing connection.", "start": 3420.78, "duration": 2.04}, {"text": "So no data passes\nthrough the KDC.", "start": 3422.82, "duration": 1.492}, {"text": "And if you already have\na ticket for something,", "start": 3424.312, "duration": 1.958}, {"text": "you can keep using\nit and keep logging", "start": 3426.27, "duration": 1.583}, {"text": "into some service\nover the network.", "start": 3427.853, "duration": 2.367}, {"text": "So in that way, it's actually\nquite nicely cacheable.", "start": 3430.22, "duration": 2.836}, {"text": "I guess the other\nnice thing these guys", "start": 3433.056, "duration": 1.624}, {"text": "do is they actually have\na way of replicating", "start": 3434.68, "duration": 2.75}, {"text": "the KDC potentially.", "start": 3437.43, "duration": 1.45}, {"text": "So they have one\nmaster Kerberos server", "start": 3438.88, "duration": 2.26}, {"text": "that stores the sort of primary\ncopy of this whole database.", "start": 3441.14, "duration": 4.66}, {"text": "And then they can have\nread only replicas that", "start": 3445.8, "duration": 3.42}, {"text": "hold a copy of this database.", "start": 3449.22, "duration": 1.34}, {"text": "They don't allow\nany updates to this", "start": 3450.56, "duration": 1.52}, {"text": "like registering users\nor updating keys.", "start": 3452.08, "duration": 3.19}, {"text": "But they do allow responding\nto login and TJS requests.", "start": 3455.27, "duration": 4.33}, {"text": "So this way, these backup\nclones of this Kerberos database", "start": 3459.6, "duration": 3.43}, {"text": "allow you to keep logging in\nand keep talking to services", "start": 3463.03, "duration": 2.83}, {"text": "even if the master\ncrashed and hopefully", "start": 3465.86, "duration": 3.99}, {"text": "make it possible to upgrade\nto master without breaking", "start": 3469.85, "duration": 3.74}, {"text": "everything at the same time.", "start": 3473.59, "duration": 2.47}, {"text": "Makes sense?", "start": 3476.06, "duration": 0.58}, {"text": "Any questions?", "start": 3476.64, "duration": 0.26}, {"text": "Yeah.", "start": 3476.9, "duration": 0.3}, {"text": "STUDENT: How hard\nis it to compromise", "start": 3477.2, "duration": 1.541}, {"text": "the KDC server and [INAUDIBLE]?", "start": 3478.741, "duration": 2.551}, {"text": "PROFESSOR: Well, yes,\nthis is a huge sort", "start": 3481.292, "duration": 2.268}, {"text": "of target for any system\nthat runs Kerberos.", "start": 3483.56, "duration": 2.292}, {"text": "Because if you\ncompromise this guy,", "start": 3485.852, "duration": 1.458}, {"text": "you're in complete\ncontrol of the system.", "start": 3487.31, "duration": 2.04}, {"text": "You can mint tickets for\nany service you want,", "start": 3489.35, "duration": 3.27}, {"text": "pretending to be\nclient you want.", "start": 3492.62, "duration": 2.48}, {"text": "So this is pretty bad.", "start": 3495.1, "duration": 1.5}, {"text": "So you really want to\nkeep this guy secure.", "start": 3496.6, "duration": 2.054}, {"text": "Now, how hard is\nit to compromise?", "start": 3498.654, "duration": 1.416}, {"text": "Well, ideally, it's hard.", "start": 3500.07, "duration": 1.53}, {"text": "And I don't know\nof any instances", "start": 3501.6, "duration": 3.85}, {"text": "where the MIT KDC has actually\nbeen compromised in, I guess,", "start": 3505.45, "duration": 4.44}, {"text": "20 years or so.", "start": 3509.89, "duration": 1.81}, {"text": "So it's , I think, possible to\nrun this reasonably security.", "start": 3511.7, "duration": 3.21}, {"text": "But presumably, the things\nyou would worry about", "start": 3514.91, "duration": 2.16}, {"text": "are just software\nimplementation security", "start": 3517.07, "duration": 3.37}, {"text": "of the things that's listening\non these two services, right?", "start": 3520.44, "duration": 2.57}, {"text": "So if there's buffer\noverflows on this guys", "start": 3523.01, "duration": 1.98}, {"text": "or some other vulnerability\nlike that, that's really bad.", "start": 3524.99, "duration": 3.86}, {"text": "Or if there's an SSH server\nrunning on the Kerberos KDC", "start": 3528.85, "duration": 3.42}, {"text": "and someone guesses the root\npassword on that SSH server,", "start": 3532.27, "duration": 3.16}, {"text": "they'll just log in and\ncopy the database over.", "start": 3535.43, "duration": 2.43}, {"text": "So I think you really want\nto be careful in minimizing", "start": 3537.86, "duration": 2.25}, {"text": "the attack surface there.", "start": 3540.11, "duration": 1.041}, {"text": "Maybe be very careful\nwriting the KDC code.", "start": 3541.151, "duration": 2.889}, {"text": "Don't allow you to\nlog into it directly.", "start": 3544.04, "duration": 2.26}, {"text": "Maybe you even worry about\nphysical security, et cetera.", "start": 3546.3, "duration": 4.76}, {"text": "Absolutely.", "start": 3551.06, "duration": 0.63}, {"text": "Luckily, this is actually\none of the few places", "start": 3551.69, "duration": 2.49}, {"text": "where you have to be\nsuper paranoid, though.", "start": 3554.18, "duration": 2.03}, {"text": "Right, so the servers,\nunlike in some other systems", "start": 3556.21, "duration": 2.81}, {"text": "that do trust all the\nmachines, the servers", "start": 3559.02, "duration": 1.92}, {"text": "are actually not that important.", "start": 3560.94, "duration": 1.83}, {"text": "They of course store some data.", "start": 3562.77, "duration": 1.64}, {"text": "But if someone compromises a\nmail server or a print server,", "start": 3564.41, "duration": 4.13}, {"text": "you can probably\nrecover reasonably well.", "start": 3568.54, "duration": 1.797}, {"text": "So actually, here's an\ninteresting question.", "start": 3570.337, "duration": 1.833}, {"text": "Like, suppose someone\ncompromised the mail server.", "start": 3572.17, "duration": 2.083}, {"text": "What should you do to\nrecover from this attack?", "start": 3574.253, "duration": 2.903}, {"text": "Like, if someone\nstole your mail,", "start": 3577.156, "duration": 1.374}, {"text": "I guess that's kind\nof unfortunate.", "start": 3578.53, "duration": 1.458}, {"text": "But what do you do so that the\nattacker doesn't keep accessing", "start": 3579.988, "duration": 2.722}, {"text": "your mail in the future?", "start": 3582.71, "duration": 1.44}, {"text": "Yeah.", "start": 3584.15, "duration": 0.51}, {"text": "STUDENT: [INAUDIBLE]", "start": 3584.66, "duration": 1.184}, {"text": "PROFESSOR: Yeah, so\nin Kerberos, there's", "start": 3585.844, "duration": 1.666}, {"text": "no sort of revoke operation.", "start": 3587.51, "duration": 2.32}, {"text": "But what you could\ndo is you could", "start": 3589.83, "duration": 1.52}, {"text": "change generate a new\nkey for the mail server", "start": 3591.35, "duration": 2.34}, {"text": "and stick it in this\ndatabase over here.", "start": 3593.69, "duration": 2.31}, {"text": "And then you install a new mail\nserver, give it the new key,", "start": 3596.0, "duration": 3.49}, {"text": "and then some attacker that\nhas the mail server's old key", "start": 3599.49, "duration": 3.39}, {"text": "has no way of-- like, no\ninfluence at all on this mail", "start": 3602.88, "duration": 3.32}, {"text": "server now, right?", "start": 3606.2, "duration": 1.967}, {"text": "On the other hand, suppose you\ndidn't change the mail server's", "start": 3608.167, "duration": 2.583}, {"text": "key, K mail.", "start": 3610.75, "duration": 2.47}, {"text": "How that is that?", "start": 3613.22, "duration": 1.506}, {"text": "STUDENT: [INAUDIBLE] fine.", "start": 3614.726, "duration": 2.566}, {"text": "PROFESSOR: OK, so suppose\nyou didn't change the mail.", "start": 3617.292, "duration": 2.208}, {"text": "You, like, install\nthe new mail server.", "start": 3619.5, "duration": 1.625}, {"text": "You patch whatever bug\nthat hacker exploited.", "start": 3621.125, "duration": 2.075}, {"text": "But it still has\nthe same key K mail.", "start": 3623.2, "duration": 1.93}, {"text": "And maybe it's taken a day so\nall the tickets are expired.", "start": 3625.13, "duration": 3.042}, {"text": "Can that hacker do anything\ninteresting in the system", "start": 3628.172, "duration": 2.208}, {"text": "anymore?", "start": 3630.38, "duration": 0.23}, {"text": "Yeah.", "start": 3630.61, "duration": 0.5}, {"text": "STUDENT: [INAUDIBLE]", "start": 3631.11, "duration": 2.552}, {"text": "PROFESSOR: Yeah, OK, so you give\nthe new mail server the old K", "start": 3633.662, "duration": 2.583}, {"text": "mail.", "start": 3636.245, "duration": 1.715}, {"text": "Is that bad?", "start": 3637.96, "duration": 1.751}, {"text": "Yeah.", "start": 3639.711, "duration": 0.499}, {"text": "STUDENT: This is--", "start": 3640.21, "duration": 1.326}, {"text": "PROFESSOR: Sure.", "start": 3643.594, "duration": 0.666}, {"text": "STUDENT: [INAUDIBLE]\nmail server.", "start": 3644.26, "duration": 4.311}, {"text": "And [INAUDIBLE] mail\nserver because you can", "start": 3648.571, "duration": 2.995}, {"text": "encrypt that initial ticket.", "start": 3651.566, "duration": 1.274}, {"text": "PROFESSOR: Right.", "start": 3652.84, "duration": 0.29}, {"text": "So K mail is actually\nsuper important.", "start": 3653.13, "duration": 1.65}, {"text": "And, OK, so you're saying you\ncan decrypt all the things", "start": 3654.78, "duration": 2.46}, {"text": "going on to the mail server.", "start": 3657.24, "duration": 1.222}, {"text": "So suppose the client now\nconnects to the mail server", "start": 3658.462, "duration": 2.208}, {"text": "after it's been fixed up.", "start": 3660.67, "duration": 1.39}, {"text": "But the attacker\nstill knows K mail", "start": 3662.06, "duration": 1.83}, {"text": "from the last time they\ncompromised the system.", "start": 3663.89, "duration": 1.96}, {"text": "They can now decrypt\nthis ticket k mail", "start": 3665.85, "duration": 2.22}, {"text": "and they can now look inside the\nticket to get the session key", "start": 3668.07, "duration": 3.312}, {"text": "and they can use that to\ndecrypt all the messages you", "start": 3671.382, "duration": 2.208}, {"text": "send, all the responses\nyou get back, and so on.", "start": 3673.59, "duration": 2.34}, {"text": "So it's pretty important\nto change this key K mail.", "start": 3675.93, "duration": 3.02}, {"text": "And in many ways, it's\nactually even worse", "start": 3678.95, "duration": 2.22}, {"text": "than just looking\nat the traffic.", "start": 3681.17, "duration": 1.53}, {"text": "Because if the attacker\nknow this key K mail,", "start": 3682.7, "duration": 3.74}, {"text": "they can synthesize new\ntickets for the mail server", "start": 3686.44, "duration": 2.74}, {"text": "without talking to the key DC.", "start": 3689.18, "duration": 1.92}, {"text": "So suppose that I\nknow K mail and I", "start": 3691.1, "duration": 1.61}, {"text": "want to read your mail\nfrom the mail server.", "start": 3692.71, "duration": 2.39}, {"text": "I'll just make up this ticket.", "start": 3695.1, "duration": 1.33}, {"text": "I'll plop down all those five\nfields in the right order.", "start": 3696.43, "duration": 2.6}, {"text": "I'll generate a new key.", "start": 3699.03, "duration": 1.92}, {"text": "I'll encrypt it with K mail.", "start": 3700.95, "duration": 1.33}, {"text": "It'll look like the real\nthing generated by the KDC.", "start": 3702.28, "duration": 2.792}, {"text": "And I'll just connect\nto the mail server.", "start": 3705.072, "duration": 1.708}, {"text": "And it'll decrypt it.", "start": 3706.78, "duration": 0.67}, {"text": "It'll decrypt correctly and\nthen it'll think, oh, yeah,", "start": 3707.45, "duration": 2.44}, {"text": "this is some particular user.", "start": 3709.89, "duration": 3.09}, {"text": "And you can read all their mail\nand you know the shared key", "start": 3712.98, "duration": 2.5}, {"text": "and so on.", "start": 3715.48, "duration": 1.11}, {"text": "So it's critically important\ntoo that no one knows", "start": 3716.59, "duration": 3.28}, {"text": "the secret key of a service.", "start": 3719.87, "duration": 1.9}, {"text": "Because otherwise, not\nonly is the traffic", "start": 3721.77, "duration": 2.35}, {"text": "to the service decryptable\nand observable,", "start": 3724.12, "duration": 2.21}, {"text": "but also you could impersonate\nanyone to that service.", "start": 3726.33, "duration": 4.08}, {"text": "So this is actually all\npretty important in Kerberos.", "start": 3730.41, "duration": 3.32}, {"text": "Makes sense?", "start": 3733.73, "duration": 1.59}, {"text": "Any questions?", "start": 3735.32, "duration": 1.826}, {"text": "Yeah.", "start": 3737.146, "duration": 0.972}, {"text": "STUDENT: So if the attacker\nhas to [INAUDIBLE],", "start": 3738.118, "duration": 2.43}, {"text": "what's stopping him from\nchanging the [INAUDIBLE] key", "start": 3740.548, "duration": 3.888}, {"text": "[INAUDIBLE]?", "start": 3744.436, "duration": 1.349}, {"text": "PROFESSOR: Yeah, so presumably,\nhow you'd recover-- like,", "start": 3745.785, "duration": 2.375}, {"text": "ISNT would, like, call up\nthe guy that runs this KDC", "start": 3748.16, "duration": 2.22}, {"text": "and say, oh man, our mail\nserver got compromised.", "start": 3750.38, "duration": 2.19}, {"text": "Why don't you go and, like,\ndelete this key from there", "start": 3752.57, "duration": 2.25}, {"text": "and put in this new key instead?", "start": 3754.82, "duration": 1.469}, {"text": "So you'd probably want to\nhave some out of bounds", "start": 3756.289, "duration": 2.041}, {"text": "mechanism for proving that\nyou're really the mail server.", "start": 3758.33, "duration": 3.24}, {"text": "Because we'll look\nat a second on how do", "start": 3761.57, "duration": 1.864}, {"text": "you change keys-- like a\npassword changing protocol,", "start": 3763.434, "duration": 2.166}, {"text": "for example.", "start": 3765.6, "duration": 0.81}, {"text": "And you can in general\nchange passwords in Kerberos.", "start": 3766.41, "duration": 3.0}, {"text": "So if you know the\nold password, you", "start": 3769.41, "duration": 1.61}, {"text": "can change the user's password\nto a new password here.", "start": 3771.02, "duration": 2.9}, {"text": "So in order to recover, you\nprobably-- like the attacker,", "start": 3773.92, "duration": 2.782}, {"text": "might get your key mail,\nchange it to something else.", "start": 3776.702, "duration": 2.208}, {"text": "Someone with ISNT basically has\nto go to the Accounts office", "start": 3778.91, "duration": 2.84}, {"text": "and say, hey,\nwe're hear at ISNT.", "start": 3781.75, "duration": 2.379}, {"text": "Could you please change the\npassword of the mail server", "start": 3784.129, "duration": 2.291}, {"text": "for us?", "start": 3786.42, "duration": 0.5}, {"text": "And they're going to\ngenerate some new password", "start": 3786.92, "duration": 1.958}, {"text": "the attacker doesn't know.", "start": 3788.878, "duration": 1.442}, {"text": "So yeah, otherwise, if the\nattacker knows this key K mail,", "start": 3790.32, "duration": 3.91}, {"text": "there's nothing differentiating\nthe attacker from you,", "start": 3794.23, "duration": 2.25}, {"text": "from the real mail\nserver operator.", "start": 3796.48, "duration": 1.76}, {"text": "In fact, the attacker probably\nchanged the key so now they", "start": 3798.24, "duration": 2.736}, {"text": "know the new thing\nand you don't.", "start": 3800.976, "duration": 1.374}, {"text": "It's like you're not on\nthe mail server anymore.", "start": 3802.35, "duration": 2.09}, {"text": "So absolutely, you need\nsome out of band protocol", "start": 3804.44, "duration": 2.77}, {"text": "for initially registering\nprinciples in the database", "start": 3807.21, "duration": 4.25}, {"text": "and for changing keys if you\nforget your password or someone", "start": 3811.46, "duration": 2.9}, {"text": "changes for you and\nyou lose it as well.", "start": 3814.36, "duration": 3.04}, {"text": "So there's someone\nat MIT or there's", "start": 3817.4, "duration": 2.62}, {"text": "a group of people at\nMIT that help users", "start": 3820.02, "duration": 2.93}, {"text": "register for accounts and\nchange their passwords", "start": 3822.95, "duration": 2.05}, {"text": "by, you know, you present your\nMIT ID and say, oh, well, OK.", "start": 3825.0, "duration": 3.44}, {"text": "Well, whatever\nhappened, we'll be", "start": 3828.44, "duration": 1.4}, {"text": "able to change your\nkey for you then.", "start": 3829.84, "duration": 1.9}, {"text": "Make sense?", "start": 3831.74, "duration": 2.15}, {"text": "So it's pretty\nimportant, of course,", "start": 3833.89, "duration": 1.5}, {"text": "to do that right so\nif the person that", "start": 3835.39, "duration": 2.6}, {"text": "is allowing password resets does\nthe wrong thing when checking", "start": 3837.99, "duration": 3.32}, {"text": "your MIT ID, you'll be able to\ncompromise the system as well,", "start": 3841.31, "duration": 2.83}, {"text": "right?", "start": 3844.14, "duration": 0.14}, {"text": "So they are sort of part\nof the trusted computing", "start": 3844.28, "duration": 2.041}, {"text": "base in Kerberos, right?", "start": 3846.321, "duration": 1.084}, {"text": "Like, anyone that can go\nand muck with the database", "start": 3847.405, "duration": 2.125}, {"text": "is pretty important\nfor security here.", "start": 3849.53, "duration": 4.46}, {"text": "All right, so let's look at\nanother sort of interesting use", "start": 3853.99, "duration": 3.159}, {"text": "of Kerberos, right?", "start": 3857.149, "duration": 0.791}, {"text": "So you could use Kerberos to try\nto log into some remote machine", "start": 3857.94, "duration": 4.81}, {"text": "over SSH.", "start": 3862.75, "duration": 1.579}, {"text": "And the way this would work\nis, of course, very similar", "start": 3864.329, "duration": 2.291}, {"text": "to a mail server.", "start": 3866.62, "duration": 0.72}, {"text": "You'd get a ticket\nfor the SSH server", "start": 3867.34, "duration": 1.541}, {"text": "and you'd send the ticket\nalong with your SSH connection.", "start": 3868.881, "duration": 3.199}, {"text": "But what if you're SSHing\ninto Athena dot dial-up", "start": 3872.08, "duration": 2.78}, {"text": "and you don't have a Kerberos\nclient on your machine?", "start": 3874.86, "duration": 2.35}, {"text": "You just want to log\ninto Athena dot dial-up", "start": 3877.21, "duration": 2.06}, {"text": "with your regular password.", "start": 3879.27, "duration": 3.09}, {"text": "So how would Athena dial-up\nauthenticate you, then,", "start": 3882.36, "duration": 2.48}, {"text": "if you're just plugging into\nthis machine with a password?", "start": 3884.84, "duration": 3.22}, {"text": "But you have no password\nfor Athena dot dial-up.", "start": 3888.06, "duration": 2.06}, {"text": "It's on a Kerberos server.", "start": 3890.12, "duration": 1.652}, {"text": "So which should\nthe dial-up machine", "start": 3891.772, "duration": 1.458}, {"text": "do when you log into\nit with a password?", "start": 3893.23, "duration": 1.65}, {"text": "Yeah.", "start": 3894.88, "duration": 0.37}, {"text": "STUDENT: You can\naccess the [INAUDIBLE].", "start": 3895.25, "duration": 1.74}, {"text": "PROFESSOR: Yeah, so\nthe dial-up is then", "start": 3896.99, "duration": 1.78}, {"text": "going to basically play the\nsame protocol logging you in.", "start": 3898.77, "duration": 2.43}, {"text": "So it's going to send a request.", "start": 3901.2, "duration": 2.65}, {"text": "This thing, right?", "start": 3903.85, "duration": 0.75}, {"text": "It's going to send a request\nto the Kerberos service asking,", "start": 3904.6, "duration": 3.36}, {"text": "give me a ticket for, I\ndon't know, this user Alice.", "start": 3907.96, "duration": 3.59}, {"text": "And in response, it's going to\nget back this reply encrypted", "start": 3911.55, "duration": 3.5}, {"text": "with Alice's password.", "start": 3915.05, "duration": 1.23}, {"text": "And then it's going to try\nthe password you just applied", "start": 3916.28, "duration": 2.97}, {"text": "and see if it\ndecrypts correctly.", "start": 3919.25, "duration": 1.8}, {"text": "And if it decrypts\ncorrectly, it's", "start": 3921.05, "duration": 1.6}, {"text": "going to let you log in, right?", "start": 3922.65, "duration": 2.62}, {"text": "Yeah.", "start": 3925.27, "duration": 0.5}, {"text": "STUDENT: You don't\neven really have", "start": 3925.77, "duration": 1.458}, {"text": "to send your key\nto the SSH server.", "start": 3927.228, "duration": 3.142}, {"text": "Because it could\nrelay this back--", "start": 3930.37, "duration": 2.47}, {"text": "the dot encrypted thing with KC.", "start": 3932.84, "duration": 2.39}, {"text": "It could relay that back to the\nuser over the SSH connection.", "start": 3935.23, "duration": 3.718}, {"text": "PROFESSOR: Potentially, yeah.", "start": 3938.948, "duration": 1.432}, {"text": "Right, so this requires\nsome fancy SSH client", "start": 3940.38, "duration": 2.18}, {"text": "that you might not have.", "start": 3942.56, "duration": 1.25}, {"text": "But-- so yeah, absolutely right.", "start": 3943.81, "duration": 1.59}, {"text": "If you want to do\nthis right, you", "start": 3945.4, "duration": 1.39}, {"text": "probably want to have a\nKerberos client on your machine", "start": 3946.79, "duration": 2.291}, {"text": "and get a ticket\nyourself or maybe", "start": 3949.081, "duration": 2.289}, {"text": "proxy it somehow\nthrough the SSH server", "start": 3951.37, "duration": 2.09}, {"text": "but not allow the SSH\nserver to have your key.", "start": 3953.46, "duration": 2.644}, {"text": "That's probably a good plan.", "start": 3956.104, "duration": 1.166}, {"text": "STUDENT: [INAUDIBLE]\njust, the server could get", "start": 3957.27, "duration": 4.248}, {"text": "through this wall [INAUDIBLE]", "start": 3961.518, "duration": 1.422}, {"text": "PROFESSOR: That's right.", "start": 3962.94, "duration": 0.168}, {"text": "Then you might decrypt\nit and send back.", "start": 3963.108, "duration": 2.057}, {"text": "OK, but in either case,\nright, all we're doing here", "start": 3965.165, "duration": 2.125}, {"text": "is someone is going to try\nto decrypt this blob with KC.", "start": 3967.29, "duration": 3.989}, {"text": "And then the server is\ngoing to get this resolved", "start": 3971.279, "duration": 2.041}, {"text": "and see if it looks right.", "start": 3973.32, "duration": 1.083}, {"text": "It's going to allow you in.", "start": 3974.403, "duration": 2.073}, {"text": "Seem like a good plan?", "start": 3976.476, "duration": 2.743}, {"text": "So, turns out this is actually\na fairly dangerous thing to do", "start": 3979.219, "duration": 2.541}, {"text": "and allows you to potentially\nlog into the SSH server", "start": 3981.76, "duration": 2.555}, {"text": "as anyone.", "start": 3984.315, "duration": 1.705}, {"text": "And the reason is\nthat previously,", "start": 3986.02, "duration": 2.63}, {"text": "when we were talking about\na client trying to log in,", "start": 3988.65, "duration": 3.28}, {"text": "the client basically\nknew that it", "start": 3991.93, "duration": 1.619}, {"text": "was trying to supply\na legitimate password,", "start": 3993.549, "duration": 1.791}, {"text": "it was getting a reply from\nthe right Kerberos server,", "start": 3995.34, "duration": 2.44}, {"text": "and if it can decrypt it, then\nprobably the password works out", "start": 3997.78, "duration": 3.09}, {"text": "correctly.", "start": 4000.87, "duration": 1.14}, {"text": "However, there's nothing\nhere in this protocol that", "start": 4002.01, "duration": 2.64}, {"text": "authenticates the fact\nthat this reply is coming", "start": 4004.65, "duration": 2.85}, {"text": "from the right Kerberos server.", "start": 4007.5, "duration": 3.17}, {"text": "So if I try to log into a\nmachine by typing in a password", "start": 4010.67, "duration": 6.8}, {"text": "and the machine sends\nout this request", "start": 4017.47, "duration": 2.61}, {"text": "and some response\ncomes back that seems", "start": 4020.08, "duration": 2.62}, {"text": "to be encrypted with\nthe password I typed in,", "start": 4022.7, "duration": 3.47}, {"text": "this response might not be\nfrom the Kerberos server.", "start": 4026.17, "duration": 3.58}, {"text": "So suppose I have some\nmachine I want to log into.", "start": 4029.75, "duration": 2.34}, {"text": "I type a password X into it.", "start": 4032.09, "duration": 2.42}, {"text": "And then the machine\nsends out this response.", "start": 4034.51, "duration": 2.45}, {"text": "And before the Kerberos\nserver can respond back", "start": 4036.96, "duration": 2.32}, {"text": "with the real reply, I'll\nsend my own reply that", "start": 4039.28, "duration": 3.93}, {"text": "looks like this real response\nencrypted with my password X.", "start": 4043.21, "duration": 4.43}, {"text": "And the workstation to which I\ntry to log in or the SSH server", "start": 4047.64, "duration": 3.9}, {"text": "is going to decrypt it\nwith my fake password.", "start": 4051.54, "duration": 2.24}, {"text": "It's going to look OK\nbecause this response was", "start": 4053.78, "duration": 2.4}, {"text": "generated by me rather than\nthe real Kerberos server.", "start": 4056.18, "duration": 3.7}, {"text": "And you'll be able to\nlog in This make sense?", "start": 4059.88, "duration": 5.515}, {"text": "Why does this happen?", "start": 4065.395, "duration": 0.875}, {"text": "Yeah.", "start": 4071.704, "duration": 0.988}, {"text": "STUDENT: [INAUDIBLE]\nthere's no authentication", "start": 4072.692, "duration": 1.976}, {"text": "from the Kerberos\nserver [INAUDIBLE]", "start": 4074.668, "duration": 1.992}, {"text": "PROFESSOR: Right,\nyeah, so there's", "start": 4076.66, "duration": 0.89}, {"text": "nothing really here that's\ntying this to the real Kerberos", "start": 4077.55, "duration": 2.39}, {"text": "server.", "start": 4079.94, "duration": 0.5}, {"text": "So the way that\nKerberos fixes this", "start": 4080.44, "duration": 4.41}, {"text": "for remotely accessible\nmachines like Athena", "start": 4084.85, "duration": 3.45}, {"text": "dot dial-up is that\nthe dial-ups themselves", "start": 4088.3, "duration": 2.8}, {"text": "have some sort of a secret key\nthat they share with the KDC.", "start": 4091.1, "duration": 3.6}, {"text": "So in order to log\nyou in into a dial-up", "start": 4094.7, "duration": 2.02}, {"text": "or to any workstation that\nreally cares about checking", "start": 4096.72, "duration": 2.49}, {"text": "whether you are\nreally the right user,", "start": 4099.21, "duration": 1.949}, {"text": "it's actually going\nto do two things.", "start": 4101.159, "duration": 1.541}, {"text": "It's going to first log you\ninto Kerberos like this.", "start": 4102.7, "duration": 3.529}, {"text": "But then just because this\nreply decrypts correctly,", "start": 4106.229, "duration": 2.651}, {"text": "it's not going to trust that.", "start": 4108.88, "duration": 1.559}, {"text": "It's going to try\nto get a service", "start": 4110.439, "duration": 2.651}, {"text": "ticket for itself using TGS.", "start": 4113.09, "duration": 2.82}, {"text": "So the dial-up machine here\nhas its own secret key.", "start": 4115.91, "duration": 3.989}, {"text": "And it logs you in\nwith this round one.", "start": 4119.899, "duration": 2.33}, {"text": "Then it talks to TGS\nsaying, oh, please give me", "start": 4122.229, "duration": 3.34}, {"text": "a service ticket for\nmy own principle,", "start": 4125.569, "duration": 3.171}, {"text": "from the dial-up\nprinciple, for this client.", "start": 4128.74, "duration": 2.619}, {"text": "Then it gets the response back.", "start": 4131.359, "duration": 1.521}, {"text": "And then it checks if it can\ndecrypt the response correctly.", "start": 4132.88, "duration": 2.599}, {"text": "Because it knows the\ndial-up key for this KS.", "start": 4135.479, "duration": 3.741}, {"text": "And if this decrpyts,\nthat it knows, oh yeah,", "start": 4139.22, "duration": 2.17}, {"text": "I must have talked to the\nright Kerberos server.", "start": 4141.39, "duration": 2.0}, {"text": "Because only the\nright Kerberos server", "start": 4143.39, "duration": 1.583}, {"text": "would have sent me this\nsecond round ticket encrypted", "start": 4144.973, "duration": 2.227}, {"text": "with my secret key K dial-up.", "start": 4147.2, "duration": 3.465}, {"text": "So this is actually\npretty important.", "start": 4150.665, "duration": 2.114}, {"text": "And typically,\nAthena workstations", "start": 4152.779, "duration": 1.965}, {"text": "don't do this extra step because\nAthena workstations don't", "start": 4154.744, "duration": 2.416}, {"text": "have any secret\nkey stored on them", "start": 4157.16, "duration": 1.94}, {"text": "that's shared with the KDC.", "start": 4159.1, "duration": 2.394}, {"text": "Why is this OK for Athena\nworkstations to let you", "start": 4161.494, "duration": 2.041}, {"text": "log in in this one round\ntrip and not for dial-ups?", "start": 4163.535, "duration": 3.0}, {"text": "Yeah.", "start": 4166.535, "duration": 0.5}, {"text": "STUDENT: If you don't have\naccess to any services", "start": 4167.035, "duration": 2.041}, {"text": "because the attacker\ncouldn't forge the ticket.", "start": 4169.076, "duration": 1.959}, {"text": "PROFESSOR: That's right, yeah.", "start": 4171.035, "duration": 1.249}, {"text": "So there's nothing interesting\non the dial-up machine itself--", "start": 4172.284, "duration": 2.776}, {"text": "sorry, on the\nworkstation itself.", "start": 4175.06, "duration": 1.45}, {"text": "So workstation, whenever-- you\nhave root access on it anyway.", "start": 4176.51, "duration": 3.15}, {"text": "So if you log into it with\na fake password, who cares?", "start": 4179.66, "duration": 3.27}, {"text": "It's not like you'll be\nable to do anything else", "start": 4182.93, "duration": 2.08}, {"text": "outside of your workstation.", "start": 4185.01, "duration": 1.509}, {"text": "Whereas on a dial-up, things\nare much more interesting.", "start": 4186.519, "duration": 2.291}, {"text": "It might be that you have\nother processes running", "start": 4188.81, "duration": 2.041}, {"text": "on the dial-up from\nother login sessions.", "start": 4190.851, "duration": 2.069}, {"text": "And there, the fact that you log\nin with a particular Unix UID", "start": 4192.92, "duration": 3.52}, {"text": "is actually pretty important.", "start": 4196.44, "duration": 1.63}, {"text": "And there, they really\nwant to authenticate", "start": 4198.07, "duration": 2.16}, {"text": "that you are the right entity.", "start": 4200.23, "duration": 2.13}, {"text": "So that's why they do this sort\nof 2-step process for logging", "start": 4202.36, "duration": 3.42}, {"text": "into some shared\ntime-sharing machine.", "start": 4205.78, "duration": 3.36}, {"text": "Make sense?", "start": 4209.14, "duration": 2.88}, {"text": "All right, so the last\nthing I want to talk about", "start": 4212.02, "duration": 3.21}, {"text": "is how do we change keys.", "start": 4215.23, "duration": 1.61}, {"text": "So we sort of talked about\nit briefly here with the idea", "start": 4216.84, "duration": 2.39}, {"text": "that the mail server's\nkey might get compromised.", "start": 4219.23, "duration": 2.799}, {"text": "But as a user, you\nprobably also want", "start": 4222.029, "duration": 1.541}, {"text": "to change passwords as well.", "start": 4223.57, "duration": 2.51}, {"text": "Like, maybe you're thinking, oh,\nthat password is not so great", "start": 4226.08, "duration": 2.781}, {"text": "anymore.", "start": 4228.861, "duration": 0.499}, {"text": "Maybe I accidentally wrote it\non a piece of paper and someone", "start": 4229.36, "duration": 2.03}, {"text": "looked at it.", "start": 4231.39, "duration": 0.89}, {"text": "So you probably\nwant to change it.", "start": 4232.28, "duration": 1.82}, {"text": "So the way this\nworks is actually", "start": 4234.1, "duration": 2.02}, {"text": "at some level fairly\nstraightforward.", "start": 4236.12, "duration": 2.03}, {"text": "So there's an extra interface\nto this Kerberos server.", "start": 4238.15, "duration": 3.29}, {"text": "In addition to Kerberos\nand TGS, there's", "start": 4241.44, "duration": 2.13}, {"text": "this extra service\ncalled kpassword.", "start": 4243.57, "duration": 1.71}, {"text": "And the service lets you\nchange your password.", "start": 4248.72, "duration": 3.97}, {"text": "And the way it works is you\nget a ticket for this service", "start": 4252.69, "duration": 3.054}, {"text": "very much like you'd get\na ticket for the mail", "start": 4255.744, "duration": 1.916}, {"text": "server or any other service.", "start": 4257.66, "duration": 2.09}, {"text": "And then you send\nyour new password", "start": 4259.75, "duration": 1.842}, {"text": "to this kpassword service\nencrypted with your session", "start": 4261.592, "duration": 2.208}, {"text": "key.", "start": 4263.8, "duration": 1.11}, {"text": "And then if everything checks\nout, your key in the database", "start": 4264.91, "duration": 3.99}, {"text": "is going to be updated\nto the new key.", "start": 4268.9, "duration": 3.43}, {"text": "Question.", "start": 4272.33, "duration": 0.74}, {"text": "STUDENT: [INAUDIBLE]\nif there was, like,", "start": 4273.07, "duration": 1.666}, {"text": "no [INAUDIBLE] they wanted to\nhave them use a [INAUDIBLE] had", "start": 4274.736, "duration": 2.603}, {"text": "to go through this.", "start": 4277.339, "duration": 0.791}, {"text": "PROFESSOR: That's right.", "start": 4278.13, "duration": 0.46}, {"text": "OK, yeah, OK.", "start": 4278.59, "duration": 0.58}, {"text": "So this is a good point.", "start": 4279.17, "duration": 0.999}, {"text": "So for changing your\npassword, remember", "start": 4280.169, "duration": 2.426}, {"text": "that we have this whole\ngoal that if someone steals", "start": 4282.595, "duration": 2.125}, {"text": "your ticket, it shouldn't be\ngood enough to completely take", "start": 4284.72, "duration": 3.55}, {"text": "over your account.", "start": 4288.27, "duration": 1.48}, {"text": "So for this reason, the key\npassword service actually", "start": 4289.75, "duration": 3.099}, {"text": "doesn't accept just any ticket.", "start": 4292.849, "duration": 1.291}, {"text": "It accepts a ticket that you\ninitially get from the Kerberos", "start": 4294.14, "duration": 2.76}, {"text": "service with your KC.", "start": 4296.9, "duration": 2.84}, {"text": "So the way this actually works\nis that inside of every ticket,", "start": 4299.74, "duration": 2.69}, {"text": "in addition to all the stuff\nI showed you there, there's", "start": 4302.43, "duration": 2.333}, {"text": "an extra bit that tells you\nwhich of these two things", "start": 4304.763, "duration": 2.787}, {"text": "gave you the ticket.", "start": 4307.55, "duration": 1.286}, {"text": "So if you get the ticket\nfrom this Kerberos server,", "start": 4308.836, "duration": 2.124}, {"text": "the bit has one.", "start": 4310.96, "duration": 1.122}, {"text": "If you get the ticket from the\nTGS server, the bit is zero,", "start": 4312.082, "duration": 2.458}, {"text": "let's say.", "start": 4314.54, "duration": 0.96}, {"text": "And then the kpassword service,\nin addition to everything", "start": 4315.5, "duration": 2.66}, {"text": "that any mail server or\nfile server would do,", "start": 4318.16, "duration": 1.877}, {"text": "it also looks at the\nbit on the ticket", "start": 4320.037, "duration": 1.583}, {"text": "and says, well, if you got it\nfrom Kerberos, that's good.", "start": 4321.62, "duration": 2.59}, {"text": "If you got it from\nTGS, that means", "start": 4324.21, "duration": 1.49}, {"text": "that maybe you stole\nsomeone's ticket", "start": 4325.7, "duration": 2.32}, {"text": "and you didn't know their\npassword right away.", "start": 4328.02, "duration": 1.98}, {"text": "So I'm not going to accept this.", "start": 4330.0, "duration": 1.88}, {"text": "So this is how a key password\nensures that you can only", "start": 4331.88, "duration": 2.66}, {"text": "change the password if you just\nknew the password immediately", "start": 4334.54, "duration": 3.097}, {"text": "prior to this.", "start": 4337.637, "duration": 0.583}, {"text": "So you never actually supply\nthe old password to kpassword.", "start": 4338.22, "duration": 3.76}, {"text": "You supply that to-- well,\nyou supply that in order", "start": 4341.98, "duration": 2.192}, {"text": "to decrypt the response\nfrom the Kerberos", "start": 4344.172, "duration": 1.708}, {"text": "server for the kpassword\npassword principal.", "start": 4345.88, "duration": 3.06}, {"text": "Makes sense?", "start": 4348.94, "duration": 2.45}, {"text": "All right, so let's\njust actually spell out", "start": 4351.39, "duration": 5.28}, {"text": "the interactions with\nthe key password service", "start": 4356.67, "duration": 3.68}, {"text": "because there'll be something\na little bit interesting there.", "start": 4360.35, "duration": 2.97}, {"text": "So when you're going to\nchange your password, what", "start": 4363.32, "duration": 5.16}, {"text": "the client is going\nto do is, of course,", "start": 4368.48, "duration": 2.92}, {"text": "obtain this initial\nticket from Kerberos.", "start": 4371.4, "duration": 3.59}, {"text": "So it sends a message to the\nKerberos service saying here", "start": 4374.99, "duration": 3.9}, {"text": "is my client ID and I want to\ntalk to the kpassword service.", "start": 4378.89, "duration": 4.87}, {"text": "And the Kerberos server is\ngoing to send a response back", "start": 4383.76, "duration": 3.46}, {"text": "including the ticket\nbetween the client", "start": 4387.22, "duration": 2.47}, {"text": "and the kpassword service\nencrypted with a key of kpass", "start": 4389.69, "duration": 6.68}, {"text": "and the shared key\nbetween KC and kpass.", "start": 4396.37, "duration": 5.431}, {"text": "Makes sense?", "start": 4401.801, "duration": 0.499}, {"text": "This is exactly this thing\nup here encrypted with KC.", "start": 4402.3, "duration": 3.695}, {"text": "Makes sense?", "start": 4405.995, "duration": 0.565}, {"text": "Everyone's runs on board?", "start": 4406.56, "duration": 1.49}, {"text": "And then very much like you talk\nto a mail server, you take this", "start": 4408.05, "duration": 2.912}, {"text": "and you send it to kpassword.", "start": 4410.962, "duration": 1.208}, {"text": "You say, well, here's my\nticket-- tckpass encrypted", "start": 4412.17, "duration": 5.25}, {"text": "with kpass.", "start": 4417.42, "duration": 2.08}, {"text": "And in addition, you\nsend your new password", "start": 4419.5, "duration": 5.87}, {"text": "and you encrypt this\nwith the key kcpass", "start": 4425.37, "duration": 4.87}, {"text": "with shared key for\nyour interaction.", "start": 4430.24, "duration": 2.1}, {"text": "I just separated these\ntwo things out here.", "start": 4432.34, "duration": 3.221}, {"text": "Make sense?", "start": 4435.561, "duration": 0.499}, {"text": "So this is the thing you\nsend to the kpassword service", "start": 4436.06, "duration": 1.59}, {"text": "with a new password encrypted\nwith the session key.", "start": 4437.65, "duration": 2.49}, {"text": "Yeah.", "start": 4440.14, "duration": 0.5}, {"text": "STUDENT: But in the [INAUDIBLE]", "start": 4440.64, "duration": 1.476}, {"text": "PROFESSOR: So if the\nattacker knows your password,", "start": 4446.367, "duration": 2.083}, {"text": "they can change your\npassword-- absolutely.", "start": 4448.45, "duration": 2.97}, {"text": "So it seems reasonable, right?", "start": 4451.42, "duration": 1.25}, {"text": "Like, there's no other way to\ntell whether it's you or not.", "start": 4452.67, "duration": 2.44}, {"text": "If someone walks up to an\nAthena workstation, types", "start": 4455.11, "duration": 1.95}, {"text": "in your username and\npassword, runs password,", "start": 4457.06, "duration": 1.987}, {"text": "change my password to this new\nthing, they know your password?", "start": 4459.047, "duration": 2.583}, {"text": "They're going to be\nable to change it.", "start": 4461.63, "duration": 1.71}, {"text": "So that's totally the\nsame in almost any system", "start": 4463.34, "duration": 1.67}, {"text": "you could imagine.", "start": 4465.01, "duration": 0.75}, {"text": "This is true for Gmail probably.", "start": 4465.76, "duration": 1.39}, {"text": "This is true for any system\nthat uses passwords in general.", "start": 4467.15, "duration": 4.09}, {"text": "The reason that we had to talk\nto the Kerberos server instead", "start": 4471.24, "duration": 2.6}, {"text": "of the TGS server here is that\nif someone steals your ticket,", "start": 4473.84, "duration": 5.77}, {"text": "then we don't want them to be\nable to change your password.", "start": 4479.61, "duration": 3.09}, {"text": "So if someone corrupts an Athena\nworkstation after you log in,", "start": 4482.7, "duration": 3.47}, {"text": "your password is gone from\nmemory, the ticket remains.", "start": 4486.17, "duration": 3.25}, {"text": "You could, in principle,\nuse the ticket", "start": 4489.42, "duration": 1.95}, {"text": "to obtain more tickets for\nthe password changing service.", "start": 4491.37, "duration": 3.546}, {"text": "But the password\nchanging service", "start": 4494.916, "duration": 1.374}, {"text": "says that's not going\nto be good enough.", "start": 4496.29, "duration": 0.98}, {"text": "It's going to look\nat this ticket", "start": 4497.27, "duration": 1.375}, {"text": "here-- ticket between the\nclient and the password service.", "start": 4498.645, "duration": 3.305}, {"text": "And if that was\nupdated through TGS,", "start": 4501.95, "duration": 2.814}, {"text": "it's going to\nreject your request.", "start": 4504.764, "duration": 1.416}, {"text": "It's only going to accept it\nif it was obtained directly", "start": 4506.18, "duration": 2.333}, {"text": "from the Kerberos\nservice using KC.", "start": 4508.513, "duration": 2.747}, {"text": "Makes sense?", "start": 4511.26, "duration": 0.501}, {"text": "Question.", "start": 4511.761, "duration": 0.499}, {"text": "STUDENT: So if you [INAUDIBLE]\npassword with the [INAUDIBLE]", "start": 4512.26, "duration": 2.534}, {"text": "Athena, right?", "start": 4514.794, "duration": 0.66}, {"text": "PROFESSOR: Yeah.", "start": 4515.454, "duration": 0.666}, {"text": "STUDENT: So if I would\nsteal your private key--", "start": 4516.12, "duration": 2.255}, {"text": "PROFESSOR: Yeah,\nso actually, KC is", "start": 4518.375, "duration": 2.215}, {"text": "basically equivalent\nto your password here.", "start": 4520.59, "duration": 2.306}, {"text": "As far as the Kerberos\nprotocol is concerned,", "start": 4522.896, "duration": 1.874}, {"text": "that don't even think\nthat you have a password.", "start": 4524.77, "duration": 1.958}, {"text": "It thinks you have\na private key KC.", "start": 4526.728, "duration": 1.782}, {"text": "If someone knows KC, that's\nbasically your password.", "start": 4528.51, "duration": 2.49}, {"text": "So you can change\nyour key from KC", "start": 4531.0, "duration": 1.678}, {"text": "to something else so you\ndon't lose this thing, yeah.", "start": 4532.678, "duration": 2.208}, {"text": "Uh, yeah, question?", "start": 4534.886, "duration": 1.804}, {"text": "STUDENT: [INAUDIBLE]\ninitial message [INAUDIBLE]", "start": 4536.69, "duration": 5.236}, {"text": "from changing the [INAUDIBLE]", "start": 4541.926, "duration": 2.484}, {"text": "PROFESSOR: Oh, you\ncan certainly get", "start": 4544.41, "duration": 1.5}, {"text": "a ticket for some other\nservice or an attacker", "start": 4545.91, "duration": 2.815}, {"text": "could drop this message\naltogether or corrupt", "start": 4548.725, "duration": 1.875}, {"text": "this exchange.", "start": 4550.6, "duration": 0.88}, {"text": "And then you're not going\nto successfully change", "start": 4551.48, "duration": 1.31}, {"text": "your password.", "start": 4552.79, "duration": 0.465}, {"text": "STUDENT: [INAUDIBLE]", "start": 4553.255, "duration": 0.833}, {"text": "PROFESSOR: Yeah, so\nthe client actually", "start": 4556.456, "duration": 1.624}, {"text": "knows exactly what service\nit wants to talk to.", "start": 4558.08, "duration": 2.27}, {"text": "So if it-- it's going\nto make sure, well,", "start": 4560.35, "duration": 6.77}, {"text": "there are some messages, some\nparts of this protocol I'm not", "start": 4567.12, "duration": 2.5}, {"text": "showing that allow the\nclient to make sure", "start": 4569.62, "duration": 2.19}, {"text": "they actually got the\nticket for the right thing.", "start": 4571.81, "duration": 2.52}, {"text": "But yeah, so the-- sorry.", "start": 4574.33, "duration": 2.87}, {"text": "Question?", "start": 4577.2, "duration": 0.5}, {"text": "STUDENT: [INAUDIBLE] very easy\nto denial of service attack", "start": 4577.7, "duration": 3.241}, {"text": "when an attacker [INAUDIBLE]\nmodifying the encrypted version", "start": 4580.941, "duration": 4.266}, {"text": "of the new password.", "start": 4585.207, "duration": 1.719}, {"text": "PROFESSOR: Yeah, so there's\nactually lot of things.", "start": 4586.926, "duration": 2.414}, {"text": "Because, for example, Kerberos\ndoesn't do authentication", "start": 4589.34, "duration": 5.052}, {"text": "properly of messages--\nit just does", "start": 4594.392, "duration": 1.458}, {"text": "encryption-- you could\ntotally corrupt this blob.", "start": 4595.85, "duration": 2.42}, {"text": "And--", "start": 4598.27, "duration": 0.5}, {"text": "STUDENT: [INAUDIBLE]", "start": 4598.77, "duration": 1.1}, {"text": "PROFESSOR: Yeah, you\ncould flip it around", "start": 4599.87, "duration": 1.054}, {"text": "and it'll decrypt\nto something else.", "start": 4600.924, "duration": 1.846}, {"text": "The service was like, oh\nyeah, that's the new password,", "start": 4602.77, "duration": 1.49}, {"text": "and set it.", "start": 4604.26, "duration": 0.622}, {"text": "And then you're\nsort of locked out.", "start": 4604.882, "duration": 1.458}, {"text": "So it seems really unfortunate.", "start": 4606.34, "duration": 1.291}, {"text": "And this is yet\nanother reason why", "start": 4607.631, "duration": 1.499}, {"text": "you want separate encryption and\nauthentication in the protocol.", "start": 4609.13, "duration": 3.195}, {"text": "There's actually an even\nbigger problem here.", "start": 4612.325, "duration": 1.875}, {"text": "But actually, yeah, question?", "start": 4614.2, "duration": 0.88}, {"text": "STUDENT: What's the\npoint of having a one way", "start": 4615.08, "duration": 1.867}, {"text": "function to [INAUDIBLE] your\npassword in KC if they're", "start": 4616.947, "duration": 2.249}, {"text": "essentially [INAUDIBLE]?", "start": 4619.196, "duration": 2.154}, {"text": "PROFESSOR: Basically because\nKC is a 56-bit ds key", "start": 4621.35, "duration": 3.71}, {"text": "and your password might\nbe of different lengths.", "start": 4625.06, "duration": 2.0}, {"text": "And even if it's longer\nthan 56 bits, which", "start": 4627.06, "duration": 2.37}, {"text": "is seven bites or\nseven characters,", "start": 4629.43, "duration": 1.93}, {"text": "you want to use all\nthose extra bytes too.", "start": 4631.36, "duration": 2.27}, {"text": "So it's mostly just to condense\nit down to a fixed width blob,", "start": 4633.63, "duration": 4.27}, {"text": "yeah.", "start": 4637.9, "duration": 1.096}, {"text": "But there's actually a much\nmore interesting problem here,", "start": 4638.996, "duration": 2.416}, {"text": "which is that suppose\nthat I change my password", "start": 4641.412, "duration": 2.578}, {"text": "and then I decide, OK,\nwell, I change my password.", "start": 4643.99, "duration": 3.83}, {"text": "A day goes by and I'm\nthinking, oh yeah, sure.", "start": 4647.82, "duration": 2.11}, {"text": "I'll tell everyone what my\nstupid old password was.", "start": 4649.93, "duration": 2.44}, {"text": "Is this a good idea in Kerberos?", "start": 4652.37, "duration": 2.83}, {"text": "Yeah.", "start": 4655.2, "duration": 0.5}, {"text": "STUDENT: [INAUDIBLE]\nimmediately expire until the--", "start": 4655.7, "duration": 2.646}, {"text": "PROFESSOR: Yeah, OK.", "start": 4658.346, "duration": 0.884}, {"text": "But someone's got to wait\nfor all my tickets to expire.", "start": 4659.23, "duration": 1.24}, {"text": "I wait for, like, a week.", "start": 4660.47, "duration": 1.91}, {"text": "And then no tickets\nare good anymore.", "start": 4662.38, "duration": 1.64}, {"text": "Can I give out my\nold password now?", "start": 4664.02, "duration": 1.591}, {"text": "Yeah.", "start": 4665.611, "duration": 0.499}, {"text": "STUDENT: It might take\na while to replicate.", "start": 4666.11, "duration": 2.279}, {"text": "PROFESSOR: Yeah,\nsuppose the replicas", "start": 4668.389, "duration": 1.541}, {"text": "are all updated,\nyeah, all the stuff.", "start": 4669.93, "duration": 1.731}, {"text": "Yeah.", "start": 4671.661, "duration": 0.499}, {"text": "STUDENT: [INAUDIBLE] if someone\nsaves the initial transaction", "start": 4672.16, "duration": 2.541}, {"text": "[INAUDIBLE] to get,\nlike, your old password", "start": 4674.701, "duration": 1.878}, {"text": "now that they have\nyour new password.", "start": 4676.579, "duration": 0.991}, {"text": "PROFESSOR: Yeah,\nso this is actually", "start": 4677.57, "duration": 0.74}, {"text": "super worrisome\nin Kerberos, which", "start": 4678.31, "duration": 1.54}, {"text": "is that-- suppose\nsome attacker was", "start": 4679.85, "duration": 1.71}, {"text": "watching all of my\nprevious password changes.", "start": 4681.56, "duration": 2.68}, {"text": "They didn't know what my\npassword was or is or anything.", "start": 4684.24, "duration": 3.45}, {"text": "But they're just saving these\npackets very diligently.", "start": 4687.69, "duration": 2.77}, {"text": "And then a month later, I\ngo and say, oh, my password", "start": 4690.46, "duration": 2.9}, {"text": "was poodle or something\nsilly like this.", "start": 4693.36, "duration": 2.46}, {"text": "And then they go say ah, ha, ha.", "start": 4695.82, "duration": 1.7}, {"text": "I can now decrypt\nthis initial thing", "start": 4697.52, "duration": 2.11}, {"text": "because it was encrypted\nwith your old KC.", "start": 4699.63, "duration": 1.92}, {"text": "And I can get this KC\nwith pass that you shared.", "start": 4701.55, "duration": 3.68}, {"text": "Then I can use this to\ndecrypt the new password", "start": 4705.23, "duration": 2.04}, {"text": "you sent to the KDC.", "start": 4707.27, "duration": 0.89}, {"text": "And even if you change\nthe password again,", "start": 4708.16, "duration": 1.75}, {"text": "I can decrypt the\nnext round as well.", "start": 4709.91, "duration": 1.59}, {"text": "And you can just keep going\nand get the newest password.", "start": 4711.5, "duration": 2.333}, {"text": "So in this particular password,\nchanging protocol, if you ever", "start": 4713.833, "duration": 4.167}, {"text": "disclose an old\npassword, then someone", "start": 4718.0, "duration": 2.04}, {"text": "could sort of unzip this whole\nchain of encrypted messages", "start": 4720.04, "duration": 3.29}, {"text": "and get your newest\npassword as well.", "start": 4723.33, "duration": 2.53}, {"text": "This is actually very\ntroublesome in the design.", "start": 4725.86, "duration": 2.0}, {"text": "Yeah.", "start": 4727.86, "duration": 0.5}, {"text": "STUDENT: Doesn't the later\nversion of Kerberos [INAUDIBLE]", "start": 4728.36, "duration": 2.755}, {"text": "PROFESSOR: Absolutely, yes.", "start": 4731.115, "duration": 1.125}, {"text": "So there's actually\na solution to this", "start": 4732.24, "duration": 1.14}, {"text": "that's not sort of fundamental.", "start": 4733.38, "duration": 1.11}, {"text": "And this is\nsomething they didn't", "start": 4734.49, "duration": 1.375}, {"text": "realize in Kerberos version 4.", "start": 4735.865, "duration": 1.295}, {"text": "There's actually this nice\nmechanism called Diffie-Hellman", "start": 4737.16, "duration": 3.45}, {"text": "that I'll just sketch\nout in like one minute", "start": 4740.61, "duration": 3.19}, {"text": "just so that you guys know\nwhen to use it or et cetera.", "start": 4743.8, "duration": 2.62}, {"text": "But it's basically a solution\nfor this kind of a problem", "start": 4746.42, "duration": 2.5}, {"text": "where you want to stop this\nunzipping from happening.", "start": 4748.92, "duration": 2.71}, {"text": "So what happens in\nthe Kerberos version", "start": 4751.63, "duration": 2.1}, {"text": "5 password changing protocol\nis that actually you", "start": 4753.73, "duration": 3.18}, {"text": "want to establish a new secret\nthat will not be apparent", "start": 4756.91, "duration": 3.46}, {"text": "if you happen to decrypt all\nthe messages on the wire.", "start": 4760.37, "duration": 2.99}, {"text": "And the way this works\nis-- this is like some math", "start": 4763.36, "duration": 2.26}, {"text": "that you don't have\nto fully understand.", "start": 4765.62, "duration": 1.666}, {"text": "But the client some random value\nX. And the kpassword server is", "start": 4767.286, "duration": 6.304}, {"text": "going to pick some\nother random value Y.", "start": 4773.59, "duration": 2.04}, {"text": "And what they send to each\nother are exponentiations", "start": 4775.63, "duration": 2.19}, {"text": "of these values.", "start": 4777.82, "duration": 1.23}, {"text": "So the client sends\nG to the power X", "start": 4779.05, "duration": 2.45}, {"text": "to the server and the server\nsends G to the power Y", "start": 4781.5, "duration": 4.31}, {"text": "back to the client.", "start": 4785.81, "duration": 1.45}, {"text": "And it turns out\nthat mathematically,", "start": 4787.26, "duration": 1.63}, {"text": "what we can do now is the\nclient can take G to the Y,", "start": 4788.89, "duration": 3.22}, {"text": "raise it to X, and get\nthis value G to the XY.", "start": 4792.11, "duration": 3.16}, {"text": "The server can take G to the\nX, raise it to the power Y,", "start": 4795.27, "duration": 3.41}, {"text": "and get G to the XY as well.", "start": 4798.68, "duration": 1.97}, {"text": "They can now use this\nsecret value G to the XY", "start": 4800.65, "duration": 3.02}, {"text": "to encrypt their\nsubsequent messages,", "start": 4803.67, "duration": 1.77}, {"text": "including the new password.", "start": 4805.44, "duration": 2.27}, {"text": "So you send the new password\nencrypted with this value G", "start": 4807.71, "duration": 3.553}, {"text": "to the XY, roughly speaking.", "start": 4811.263, "duration": 2.137}, {"text": "But for some\nmathematical reasons", "start": 4813.4, "duration": 1.43}, {"text": "that we're not going\nto cover right now,", "start": 4814.83, "duration": 1.77}, {"text": "it turns out to be super\ndifficult for someone that just", "start": 4816.6, "duration": 2.75}, {"text": "gets G to the X and G to the Y\nby examining your packets later", "start": 4819.35, "duration": 4.0}, {"text": "from figuring out\nwhat was G to the XY.", "start": 4823.35, "duration": 2.85}, {"text": "So this is something called\nthe discrete log problem.", "start": 4826.2, "duration": 2.36}, {"text": "Yeah, question?", "start": 4828.56, "duration": 0.79}, {"text": "STUDENT: But they have to\n[INAUDIBLE] G at some point.", "start": 4829.35, "duration": 1.79}, {"text": "PROFESSOR: Yeah, yeah.", "start": 4831.14, "duration": 0.43}, {"text": "So G is some parameter\nyou could sort of send", "start": 4831.57, "duration": 1.965}, {"text": "at the beginning of a protocol\nor it could be just cooked", "start": 4833.535, "duration": 2.375}, {"text": "into Kerberos.", "start": 4835.91, "duration": 0.73}, {"text": "It turns out to be\nrelatively less important.", "start": 4836.64, "duration": 5.39}, {"text": "All right, so anyway, use\nDiffie-Hellman because this", "start": 4842.03, "duration": 2.38}, {"text": "is called-- well, what you\nshould Google for if you're", "start": 4844.41, "duration": 2.25}, {"text": "building a protocol like this\nis this Diffie-Hellman key", "start": 4846.66, "duration": 4.26}, {"text": "exchange protocol.", "start": 4850.92, "duration": 1.03}, {"text": "And Kerberos 5 actually\ndoes this correctly.", "start": 4851.95, "duration": 2.352}, {"text": "But this is something\nto really watch out", "start": 4854.302, "duration": 1.708}, {"text": "for if you're designing any\nkind of new protocol yourself.", "start": 4856.01, "duration": 3.159}, {"text": "All right, so that's\nit for Kerberos.", "start": 4859.169, "duration": 1.541}, {"text": "Let's talk about SSL on Monday.", "start": 4860.71, "duration": 2.45}]